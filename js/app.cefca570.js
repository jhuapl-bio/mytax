(function(){"use strict";var e={3690:function(e,t,a){var s=a(144),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-app-bar",{attrs:{app:"",color:"light",dark:"",absolute:"",dense:""}},[a("v-toolbar-title",[e._v("Real Time Nanopore Report Analysis")]),a("v-spacer"),!e.samplesheetdata||e.samplesheetdata.length<=0?a("span",{staticStyle:{"margin-right":"10px"}},[e._v("No Data Loaded")]):e._e(),a("v-checkbox",{staticStyle:{"text-align":"center"},on:{click:function(t){return e.runBundleUpdate(t)}},scopedSlots:e._u([{key:"label",fn:function(){return[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("div",e._g({},s),[a("v-icon",[e._v(" mdi-card-plus ")]),e._v(" Enable Name Mapping ")],1)]}}])},[e._v(" If you have a names.dmp file (pre-loaded as well), map additional names to taxids such as common name ")])]},proxy:!0}]),model:{value:e.runBundle,callback:function(t){e.runBundle=t},expression:"runBundle"}}),a("v-spacer"),a("v-checkbox",{staticStyle:{"text-align":"center"},scopedSlots:e._u([{key:"label",fn:function(){return[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("div",e._g({},s),[a("v-icon",[e._v(" mdi-expansion-card ")]),e._v(" Enable GPU ")],1)]}}])},[e._v(" If you have a NVIDIA GPU Card with Cuda installed, enable GPU ")])]},proxy:!0}]),model:{value:e.gpu,callback:function(t){e.gpu=t},expression:"gpu"}}),a("v-spacer"),a("v-btn",{attrs:{"btn-and-icon":"",color:"blue "},on:{mouseover:function(t){e.navigation.shown=!0},click:function(t){e.navigation.shown=!0}}},[e.anyRunning?a("v-progress-circular",{staticClass:"mr-2",attrs:{indeterminate:!0,top:"",stream:"",size:"14",color:"white"}}):e._e(),e._v(" Data Sheet "),!e.samplesheetdata||e.samplesheetdata.length<=0?a("span",{staticClass:"pulse"}):a("v-icon",{staticClass:"ml-2"},[e._v("mdi-export")])],1)],1),a("div",{staticClass:"pt-6 "},[a("v-navigation-drawer",{ref:"information_panel_drawer",staticClass:"pt-6",attrs:{permanent:"",app:"",left:"",width:e.navigation.width},model:{value:e.navigation.shown,callback:function(t){e.$set(e.navigation,"shown",t)},expression:"navigation.shown"}},[a("Samplesheet",{attrs:{samplesheet:e.samplesheetdata,queueLength:e.queueLength,bundleconfig:e.bundleconfig,seen:e.samplekeys,current:e.current,queueList:e.status,anyRunning:e.anyRunning,pausedServer:e.pausedServer,logs:e.logs,samplesheetName:e.samplesheet},on:{sendNewWatch:e.sendNewWatch,sendMessage:e.sendMessage,cancel:e.cancel,updateData:e.updateData,barcode:e.barcode,rerun:e.rerun,pausedChange:e.pausedChange,updateConfig:e.updateConfig,deleteRow:e.deleteRow}}),a("div",{staticStyle:{"overflow-y":"auto"},attrs:{id:"file"},on:{drop:function(t){return t.preventDefault(),e.addDropFileData.apply(null,arguments)},dragover:function(e){e.preventDefault()}}},[a("v-file-input",{attrs:{hint:"Add Another Kraken2 Report File","persistent-hint":"",counter:"","show-size":"",overlap:""},on:{input:e.addData},model:{value:e.recentDataFileadded,callback:function(t){e.recentDataFileadded=t},expression:"recentDataFileadded"}})],1),a("div",{staticClass:"mx-4"},[a("v-autocomplete",{staticClass:"mt-3",attrs:{items:e.selectedsamplesAll,chips:"",outlined:"",label:"Samples",multiple:""},scopedSlots:e._u([{key:"prepend-item",fn:function(){return[a("v-list-item",{attrs:{ripple:""},on:{mousedown:function(e){e.preventDefault()},click:e.toggleSamples}},[a("v-list-item-action",[a("v-icon",{attrs:{color:e.selectedsamples.length>0?"indigo darken-4":""}},[e._v(" "+e._s(e.icon)+" ")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v(" Select All ")])],1)],1),a("v-divider",{})]},proxy:!0},{key:"selection",fn:function(t){var s=t.attr,n=t.on,l=t.item,i=t.selected;return[a("v-chip",e._g(e._b({staticClass:"white--text ",attrs:{small:"","input-value":i,color:"blue-grey"}},"v-chip",s,!1),n),[e.current&&e.current[l]?a("v-progress-circular",{attrs:{indeterminate:"",color:"white",small:"",size:"15"}}):a("v-icon",{attrs:{small:"",color:(e.samplekeys&&e.samplekeys.indexOf(l),"white")}},[e._v(" "+e._s(!e.status[l]||e.status[l]&&-1!=e.status[l].success?"mdi-check-circle":"mdi-exclamation")+" ")]),a("span",{staticClass:"ml-2",domProps:{textContent:e._s(l)}}),e.manuals[l]?a("v-icon",{attrs:{small:"",color:"white"},on:{click:function(t){return e.deleteRow(l)}}},[e._v(" mdi-cancel ")]):e._e()],1)]}}]),model:{value:e.selectedsamples,callback:function(t){e.selectedsamples=t},expression:"selectedsamples"}}),a("v-spacer",{staticClass:"py-0"}),a("v-text-field",{attrs:{hint:"Max Depth of Tax Tree","persistent-hint":"","single-line":"",type:"number"},model:{value:e.maxDepth,callback:function(t){e.maxDepth=t},expression:"maxDepth"}}),a("v-text-field",{attrs:{hint:"Min Depth of Tax Tree","persistent-hint":"","single-line":"",type:"number"},model:{value:e.minDepth,callback:function(t){e.minDepth=t},expression:"minDepth"}}),a("v-spacer",{staticClass:"py-4"}),a("v-text-field",{attrs:{hint:"Min Percent in Sample","persistent-hint":"","single-line":"",type:"number"},model:{value:e.minPercent,callback:function(t){e.minPercent=t},expression:"minPercent"}}),a("v-slider",{attrs:{min:0,step:.005,max:1},model:{value:e.minPercent,callback:function(t){e.minPercent=t},expression:"minPercent"}}),a("v-spacer",{staticClass:"py-4"}),a("v-select",{attrs:{label:"Tax Rank Codes",multiple:"",items:e.defaultsList,"item-text":"value","item-value":"value","persistent-hint":""},on:{change:e.filter},scopedSlots:e._u([{key:"prepend-item",fn:function(){return[a("v-list-item",{attrs:{ripple:""},on:{mousedown:function(e){e.preventDefault()},click:e.toggle}},[a("v-list-item-action",[a("v-icon",{attrs:{color:e.defaults.length>0?"indigo darken-4":""}},[e._v(" "+e._s(e.icon)+" ")])],1),a("v-list-item-content",[a("v-list-item-title",[e._v(" Select All ")])],1)],1),a("v-divider",{staticClass:"mt-2"})]},proxy:!0}]),model:{value:e.defaults,callback:function(t){e.defaults=t},expression:"defaults"}})],1)],1)],1),a("v-main",["Connected"!=e.connectedStatus?a("v-alert",{attrs:{type:"error"}},[e._v(e._s(e.connectedStatus))]):e._e(),a("v-row",{staticClass:"ml-4"},[a("v-col",{staticClass:"overflow-y-auto  my-0",attrs:{sm:"12",id:""}},[a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},e._l(e.tabs,(function(t,s){return a("v-tab-item",{key:s+"-item",attrs:{"align-with-title":""}},[a("v-container",{staticClass:"my-3"},[a(t.component,{tag:"component",attrs:{sampleData:e.selectedData,bundleconfig:e.bundleconfig,namesData:e.uniquenametypes,fullsize:e.fullsize,selectedsamples:e.selectedsamples,socket:e.socket}})],1)],1)})),1)],1)],1)],1)],1)},l=[],i=(a(1703),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{ref:"boxContainer"},[a("v-toolbar-title",[e._v(" Top Taxa Calls Per Sample ")]),a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("div",{staticStyle:{display:"flex"}},[a("v-text-field",{attrs:{hint:"Maximum Taxa Seen per sample","persistent-hint":"",outlined:"","single-line":"",dense:"",type:"number",min:"1"},model:{value:e.top_n,callback:function(t){e.top_n=t},expression:"top_n"}}),a("v-spacer"),a("v-select",{attrs:{solo:"",items:e.grouponSelections,"item-value":"value","item-text":"name",hint:"Select Group By Value","single-line":"","return-object":"","persistent-hint":""},model:{value:e.groupon,callback:function(t){e.groupon=t},expression:"groupon"}}),a("v-select",{attrs:{solo:"",items:e.valueAttrSelections,"item-value":"value","item-text":"name",hint:"Choose Cell Values","single-line":"","return-object":"","persistent-hint":""},model:{value:e.valueAttr,callback:function(t){e.valueAttr=t},expression:"valueAttr"}})],1),a("div",{staticStyle:{position:"relative",background:"none","padding-bottom":"0px","background-opacity":"0.5",width:"100%","overflow-y":"auto","overflow-x":"auto"},attrs:{id:"platesDiv"}})])],1)],1)}),r=[],o=a(6693),d={name:"Plates",props:["inputdata","socket","samplenames","selectedTaxid","selectedAttribute","legendPlacement","selectedNameAttr"],watch:{groupon(e){this.makePlot()},valueAttr(e){this.makePlot()},selectedAttribute(e){e&&this.makePlot()},selectedNameAttr(e){this.makePlot()},top_n(){this.makePlot()},samplenames(e){e&&this.makePlot()},inputdata:{deep:!0,handler(e){e&&this.makePlot()}}},data:()=>({width:500,valueAttr:{value:"num_fragments_clade_fraction",name:"Percent of entire report for clade"},valueAttrSelections:[{value:"value",name:"Relative Percent at Rank"},{value:"num_fragments_assigned_fraction",name:"Percent of entire report for specific taxa"},{value:"num_fragments_clade_fraction",name:"Percent of entire report for clade"},{value:"num_fragments_clade",name:"Raw Framents Assigned to clade"},{value:"num_fragments_assigned",name:"Raw Fragments Assigned Specific Taxa"}],groupon:{value:"target",name:"Taxonomic Name"},grouponSelections:[{value:"target",name:"Taxonomic Name"},{value:"taxid",name:"Taxid"},{value:"source",name:"Parent Tax Name"}],parseddata:{},fullsize:{},height:500,top_n:11,dimensions:{windowHeight:0,windowWidth:0,height:0,width:0}}),methods:{getText(e){const t=this;return t.selectedNameAttr?"default (scientific name)"==t.selectedNameAttr?e.target:e.objfull&&e.objfull[t.selectedNameAttr]&&e.objfull[t.selectedNameAttr].length>0?e.objfull[t.selectedNameAttr][0]:e.target:e.target},makePlot(){let e=o.td_("#platesDiv");o.td_("#svgPlates").remove(),o.td_("#svgLegend").remove();let t=Object.keys(this.inputdata),a=[];for(let[$,V]of Object.entries(this.inputdata))if(V){let e=V.filter((e=>e.rank_code==this.selectedAttribute));this.fullsize[$]=o.Smz(V,(e=>e.num_fragments_assigned));let t=o.Q3u(e,(e=>o.Smz(e,(e=>(e.num_fragments_assigned_fraction=e.num_fragments_assigned/this.fullsize[$],e.num_fragments_clade_fraction=e.num_fragments_clade/this.fullsize[$],e[this.valueAttr.value])))),(e=>"taxid"==this.groupon.value?`${e.target}-${e.source} (${e[this.groupon.value]})`:e[this.groupon.value])),s=t.sort(((e,t)=>t[1]-e[1])),n=this.top_n;if(this.parseddata[$]=s,s.length>0)for(let l=0;l<n;l++)l<s.length&&a.push({name:$,top:s[l][0],abu:s[l][1]});else a.push({name:$,top:"Nothing",abu:1})}const s=this;let n="target";this.selectedNameAttr&&"default (scientific name)"==!this.selectedNameAttr&&(n=this.selectedNameAttr);let l={},i=[...new Set(a.map((e=>{if(e.top&&-1!==e.top)return l[e.top]=`${this.getText(e.top)}`,e.top})))],r={};for(let[$,V]of Object.entries(this.parseddata))if($){var d=o.BYU().range(["#5ff4ff","#c42bd4"]).domain(o.Wem(V,(e=>e[1])));r[$]=d}var c=e.node();function u(e,t){e.each((function(){var e,a=o.Ys(this),s=a.text().split(/\s+/).reverse(),n=[],l=0,i=1.1,r=a.attr("y"),d=parseFloat(a.attr("dy")),c=a.text(null).append("tspan").attr("x",0).attr("y",r).attr("dy",d+"em");while(e=s.pop())n.push(e),c.text(n.join(" ")),c.node().getComputedTextLength()>t&&(n.pop(),c.text(n.join(" ")),n=[e],c=a.append("tspan").attr("x",0).attr("y",r).attr("dy",`${++l*i+d}em`).text(e))}))}this.width=c.getBoundingClientRect().width,this.boxHeight=40;var m={top:50,right:30,bottom:100,left:150};this.height=this.boxHeight*t.length+m.top+1.5*this.boxHeight,o.Ys("#platesDiv").style("height",`${this.height} px`);var p=this.width-m.left-m.right,h=this.height-m.top-m.bottom;this.margin=m,this.boxWidth=(p-this.margin.left-this.margin.right)/i.length;let f=o.sPX().scaleExtent([1,3]).translateExtent([[0-this.margin.left,0-this.margin.top-this.boxHeight/2],[this.width,this.height]]).on("zoom",g);function g(e){return v.attr("transform",e.transform)}var v=e.append("svg").attr("id","svgPlates").attr("width","100%").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",`0 0 ${this.width} ${h+m.top+m.bottom}`).classed("svg-content",!0).style("cursor","pointer").call(f).append("g").attr("transform","translate("+m.left+","+m.top+")"),x=o.PKp().domain([]).range(i.map(((e,t)=>t*this.boxWidth+this.margin.left-this.margin.right))),b=o.PKp().domain(t).range(t.map(((e,t)=>t*this.boxHeight+this.margin.top-this.margin.bottom)));const y=v.selectAll("g.nodestop2").data(a).join("g").attr("class","nodestop2").attr("transform",(e=>`translate(${x(e.top)}, ${b(e.name)})`));y.append("rect").attr("width",this.boxWidth).attr("height",this.boxHeight).style("fill",(e=>e.abu?r[e.name](`${e.abu}`):"white")),y.append("text").classed("nodeText",!0).attr("font-family","sans-serif").attr("font-size","1em").attr("x",this.boxWidth/2).attr("y",(()=>this.boxHeight/2)).attr("dominant-baseline","middle").attr("text-anchor","middle").text((e=>e.abu?"num_fragments_clade"!=this.valueAttr.value&&"num_fragments_assigned"!=this.valueAttr.value?`${e.abu.toFixed(2)}%`:`${e.abu}`:""));var _=o.LLu().scale(x).tickFormat(((e,t)=>e));let k={},S={},w=v.append("g").attr("transform","translate("+this.boxWidth/2+","+(this.height-this.margin.bottom-this.margin.top)+")").attr("class","xAxisPlate").style("font-size","1px").call(_);w.selectAll("text").style("font-size",22).style("overflow","auto").attr("transform","rotate(0)").style("text-anchor","center"),w.selectAll(".tick text").call(u,s.margin.top),w.selectAll("text").style("font-size","1px").each(D).style("font-size",(function(e){return S[e]+"px"}));var C=o.y4O().scale(b);let A=v.append("g").attr("transform","translate("+this.margin.left/2+","+this.boxHeight/2+")").attr("class","yAxis").style("font-size","1px").call(C);function T(e){var t=this.getBBox(),a=s.margin.left+s.margin.left/2,n=Math.min(a/t.width,s.boxHeight);return k[e]=n,e}function D(e){var t=this.getBBox(),a=s.margin.bottom-s.margin.top,n=Math.min(a/t.height,s.height,s.boxWidth/t.width);return S[e]=n,e}A.selectAll("text").style("font-size","1px").each(T).style("font-size",(function(e){return k[e]+"px"}))}},mounted(){this.inputdata&&this.makePlot()}},c=d,u=a(3736),m=a(3453),p=a.n(m),h=a(266),f=a(2118),g=a(1713),v=a(7135),x=a(3687),b=a(7808),y=a(7953),k=(0,u.Z)(c,i,r,!1,null,null,null),S=k.exports;p()(k,{VCol:h.Z,VContainer:f.Z,VRow:g.Z,VSelect:v.Z,VSpacer:x.Z,VTextField:b.Z,VToolbarTitle:y.qW});var w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-row",[a("v-col",{attrs:{sm:"12"}},[0==e.dataSamples.length?a("v-alert",{attrs:{type:"warning"}},[e._v(" Your Datasheet is Empty, please add rows manually or upload your own Samplesheet.csv file ")]):e._e(),a("v-toolbar",{attrs:{extended:""},scopedSlots:e._u([{key:"extension",fn:function(){return[a("div",{staticClass:"mb-4 mt-3",staticStyle:{display:"flex"}},[a("div",{staticStyle:{"overflow-y":"auto"},attrs:{id:"filedropfilename"},on:{drop:function(t){return t.preventDefault(),e.addDropFile.apply(null,arguments)},dragover:function(e){e.preventDefault()}}},[a("v-file-input",{attrs:{width:"100px",hint:e.samplesheetName,"persistent-hint":"",counter:"","show-size":"",overlap:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),e.dataSamples.length>0?a("vue-json-to-csv",{attrs:{"csv-title":e.CSVTITLE,"json-data":e.dataSamples}},[a("v-tooltip",{scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({attrs:{fab:"",dark:"","x-small":""}},s),[a("v-icon",[e._v("mdi-download")])],1)]}}],null,!1,4077979467)},[e._v(" Download Samplesheet ")])],1):e._e()],1)]},proxy:!0}])},[a("v-btn",{attrs:{color:"black lighten-2",dark:""},on:{click:function(t){e.sheet=!0}}},[e._v(" Logs "),a("v-tooltip",{scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-icon",e._g({staticClass:"ml-2",attrs:{small:""}},s),[e._v("mdi-comment")])]}}])},[e._v(" View Logging ")])],1),a("v-tooltip",{scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({staticClass:"mx-2",attrs:{fab:"",color:"info","x-small":""},on:{click:function(t){return e.forceRestart()}}},s),[a("v-icon",[e._v("mdi-restart")])],1)]}}])},[e._v(" Restart All Jobs ")]),a("v-tooltip",{scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({staticClass:"mx-2",attrs:{color:"primary ",dark:"","x-small":"",fab:""},on:{click:function(t){return e.flush()}}},s),[a("v-icon",[e._v("mdi-close-circle-multiple-outline")])],1)]}}])},[e._v(" Stop All Jobs ")]),e.paused?e._e():a("v-tooltip",{key:e.paused+"-pausedbutton",scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-badge",{attrs:{color:"green lighten-2",overlap:"",content:""+(e.queueLength>0?e.queueLength:"")}},[a("v-btn",e._g({staticClass:"mx-2 ",attrs:{color:"orange ",dark:"",fab:"","x-small":""},on:{click:function(t){e.paused=!0}}},s),[a("v-icon",[e._v("mdi-pause-circle")])],1)],1)]}}],null,!1,259829553)},[e._v(" Pause Queued Jobs ")]),e.paused?a("v-tooltip",{scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({staticClass:"mx-2",attrs:{color:"secondary ",dark:"",fab:"","x-small":""},on:{click:function(t){e.paused=!1}}},s),[a("v-icon",[e._v("mdi-play-box")])],1)]}}],null,!1,1797491558)},[e._v(" Resume Jobs Waiting ")]):e._e(),a("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on,n=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"mx-2",attrs:{fab:"",color:"primary",dark:"","x-small":""}},"v-btn",n,!1),s),[a("v-tooltip",{scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-icon",e._g({},s),[e._v("mdi-plus")])]}}],null,!0)},[e._v(" Add Entry To Samplesheet ")])],1)]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"text-h5"},[e._v(e._s(e.formTitle))])]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-text-field",{attrs:{label:"Sample Name"},model:{value:e.editedItem.sample,callback:function(t){e.$set(e.editedItem,"sample",t)},expression:"editedItem.sample"}})],1),a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-text-field",{attrs:{label:"Path 1"},model:{value:e.editedItem.path_1,callback:function(t){e.$set(e.editedItem,"path_1",t)},expression:"editedItem.path_1"}})],1),a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-text-field",{attrs:{label:"Path 2"},model:{value:e.editedItem.path_2,callback:function(t){e.$set(e.editedItem,"path_2",t)},expression:"editedItem.path_2"}})],1),a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-text-field",{attrs:{label:"Database"},model:{value:e.editedItem.database,callback:function(t){e.$set(e.editedItem,"database",t)},expression:"editedItem.database"}})],1),a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-select",{attrs:{items:["file","directory"],label:"Type/Format"},model:{value:e.editedItem.format,callback:function(t){e.$set(e.editedItem,"format",t)},expression:"editedItem.format"}})],1),a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-select",{attrs:{items:["TRUE","FALSE"],label:"Compressed"},model:{value:e.editedItem.compressed,callback:function(t){e.$set(e.editedItem,"compressed",t)},expression:"editedItem.compressed"}})],1),a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-select",{attrs:{items:["oxford","illumina"],label:"Platform"},model:{value:e.editedItem.platform,callback:function(t){e.$set(e.editedItem,"platform",t)},expression:"editedItem.platform"}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:"","x-small":""},on:{click:e.closeItem}},[e._v(" Cancel ")]),a("v-btn",{attrs:{color:"blue darken-1","x-small":"",text:""},on:{click:e.saveItem}},[e._v(" Save ")])],1)],1)],1),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialogDelete,callback:function(t){e.dialogDelete=t},expression:"dialogDelete"}},[a("v-card",[a("v-card-title",{staticClass:"text-h5"},[e._v("Are you sure you want to delete this item?")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{"x-small":"",color:"blue darken-1",text:""},on:{click:e.closeDelete}},[e._v("Cancel")]),a("v-btn",{attrs:{"x-small":"",color:"blue darken-1",text:""},on:{click:e.deleteItemConfirm}},[e._v("OK")]),a("v-spacer")],1)],1)],1),a("v-dialog",{scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on,n=t.attrs;return[a("v-btn",e._g(e._b({staticClass:"mx-4",attrs:{color:"red lighten-2",dark:"",fab:"","x-small":""}},"v-btn",n,!1),s),[a("v-tooltip",{attrs:{left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-icon",e._g({},s),[e._v("mdi-cog")])]}}],null,!0)},[e._v(" Advanced Configurations ")])],1)]}}]),model:{value:e.dialogAdvanced,callback:function(t){e.dialogAdvanced=t},expression:"dialogAdvanced"}},[a("v-toolbar",{attrs:{extended:"",dark:""},scopedSlots:e._u([{key:"extension",fn:function(){return[a("v-tabs",{attrs:{"align-with-title":"",color:"basil"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tabs-slider",{attrs:{color:"purple"}}),e._l(e.tabs,(function(t,s){return a("v-tab",{key:s+"-tab"},[e._v(" "+e._s(t)+" ")])}))],2)]},proxy:!0}])}),a("v-tabs-items",{attrs:{width:"100%"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tab-item",{key:"one"},[e.stagedBundleConfig?a("v-card",[a("v-card-title",{staticClass:"text-h5 grey lighten-2"},[e._v(" Names Mapping Config ")]),a("v-list",e._l(Object.entries(e.stagedBundleConfig),(function(t){var s=t[0],n=t[1];return a("v-list-item",{key:s+"-advancedbundled"},[n&&"object"!=typeof n?e._e():a("v-sheet",{attrs:{width:"100%"}},["boolean"==typeof n.value?a("v-checkbox",{attrs:{label:s+": -"+e.stagedBundleConfig[s].arg},model:{value:e.stagedBundleConfig[s].value,callback:function(t){e.$set(e.stagedBundleConfig[s],"value",t)},expression:"stagedBundleConfig[key].value"}}):"number"==typeof n.value?a("v-text-field",{attrs:{type:"number",label:s+": -"+e.stagedBundleConfig[s].arg},model:{value:e.stagedBundleConfig[s].value,callback:function(t){e.$set(e.stagedBundleConfig[s],"value",t)},expression:"stagedBundleConfig[key].value"}}):a("v-text-field",{attrs:{label:s+": -"+e.stagedBundleConfig[s].arg},model:{value:e.stagedBundleConfig[s].value,callback:function(t){e.$set(e.stagedBundleConfig[s],"value",t)},expression:"stagedBundleConfig[key].value"}})],1)],1)})),1),a("v-card-actions",[a("v-btn",{attrs:{small:"",type:"info","x-small":""},on:{click:function(t){return e.updateConfig("bundle")}}},[e._v(" Update Config ")])],1)],1):e._e()],1),a("v-tab-item",{key:"two"},[a("v-card",[a("v-card-title",{staticClass:"text-h5 grey lighten-2"},[e._v(" Kraken2 Advanced commands ")]),a("v-list",e._l(Object.entries(e.config),(function(t){var s=t[0],n=t[1];return a("v-list-item",{key:s+"-advancedkraken2"},["boolean"==typeof n?a("v-checkbox",{attrs:{label:"--"+s+"?"},model:{value:e.config[s],callback:function(t){e.$set(e.config,s,t)},expression:"config[key]"}}):a("v-text-field","number"==typeof n?{attrs:{type:"number",label:"--"+s},model:{value:e.config[s],callback:function(t){e.$set(e.config,s,t)},expression:"config[key]"}}:{attrs:{label:"--"+s},model:{value:e.config[s],callback:function(t){e.$set(e.config,s,t)},expression:"config[key]"}})],1)})),1),a("v-card-actions",[a("v-btn",{attrs:{small:"",type:"info","x-small":""},on:{click:function(t){return e.updateConfig("kraken2")}}},[e._v(" Update Config ")])],1)],1)],1)],1)],1)],1),a("v-spacer"),a("v-dialog",{attrs:{inset:""},model:{value:e.sheet,callback:function(t){e.sheet=t},expression:"sheet"}},[a("v-card",{staticClass:"text-left logDiv ",staticStyle:{overflow:"auto"}},[a("v-toolbar",{attrs:{dark:""}},[a("v-toolbar-title",[e._v("Server Logs")]),a("v-spacer"),a("v-btn",{attrs:{icon:"","x-large":"",fab:""},on:{click:function(t){e.sheet=!1}}},[a("v-icon",{attrs:{large:""}},[e._v("mdi-close-circle")])],1)],1),a("v-card-text",{staticClass:"my-3 mb-2",staticStyle:{"max-height":"80vh","overflow-y":"auto"}},e._l(e.logs.slice().reverse(),(function(t,s){return a("span",{key:"sheet"+s},["error"==t.level?a("v-icon",{attrs:{dark:"",left:"",color:"red"}},[e._v(" mdi-alert-circle-outline ")]):a("v-icon",{attrs:{dark:"",left:"",color:"blue"}},[e._v(" mdi-information ")]),a("code",[e._v(e._s(t.message))]),a("br")],1)})),0)],1)],1),a("v-card",{staticClass:"pt-5"},[a("v-list",{style:{"align-items":"left",padding:0,margin:0}},e._l(e.samples,(function(t){return a("v-list-group",{key:t.sample,attrs:{"no-action":""},scopedSlots:e._u([{key:"activator",fn:function(){return[a("v-list-item-content",[a("v-list-item-title",[e._v(e._s(t.sample))])],1),a("v-list-item-action",[a("div",{staticStyle:{display:"flex"}},[a("v-tooltip",{scopedSlots:e._u([{key:"activator",fn:function(s){var n=s.on,l=s.attrs;return[a("v-icon",e._g(e._b({attrs:{medium:"",color:"indigo"},on:{click:function(a){return e.forceRestart(t)}}},"v-icon",l,!1),n),[e._v(" "+e._s(t.demux?"mdi-view-week":"mdi-play-circle")+" ")])]}}],null,!0)},[a("span",[e._v(e._s(t.demux?"Demux a directory of fastq files":"Classify the path of fastq(s)")+" ")])]),a("span",[e._v(e._s(t.demux?"Demux":"Classify")+" ")])],1)]),a("v-list-item-action",[a("v-btn",{attrs:{fab:"","x-small":""},on:{click:function(a){e.selectedSample=e.queueList[t.sample],e.dialogJobs=!0}}},[a("v-icon",[e._v("mdi-comment")])],1)],1),a("v-spacer"),a("v-list-item-action",[a("v-icon",{attrs:{medium:"",color:""},on:{click:function(a){return e.editItem(t)}}},[e._v(" mdi-pencil ")]),e.current&&"object"==typeof e.current&&e.current[t.sample]?a("v-progress-circular",{attrs:{indeterminate:"",color:"primary",medium:"",size:"22"}}):"run"!==t.format?a("v-icon",{key:t.sample+"-runsamplemajorbutton",attrs:{medium:"",color:e.anyCompleted(t.sample)?"green":"orange"}},[e._v(" "+e._s(e.anyCompleted(t.sample)?"mdi-check-circle":"mdi-exclamation")+" ")]):e._e()],1),a("v-list-item-action",[a("v-tooltip",{attrs:{left:""},scopedSlots:e._u([{key:"activator",fn:function(s){var n=s.on,l=s.attrs;return[a("v-icon",e._g(e._b({attrs:{medium:"",color:"indigo"},on:{click:function(a){return e.cancelJob(null,t.sample)}}},"v-icon",l,!1),n),[e._v(" mdi-cancel ")])]}}],null,!0)},[a("span",[e._v("Cancel Sample Job(s)")])]),a("v-icon",{attrs:{medium:"",color:"orange"},on:{click:function(a){return e.deleteItem(t)}}},[e._v(" mdi-delete ")])],1)]},proxy:!0}],null,!0),model:{value:t.active,callback:function(a){e.$set(t,"active",a)},expression:"sample.active"}},e._l(Object.keys(t).filter((function(e){return"sample"!=e&&"active"!=e})),(function(s){return a("v-list-item",{key:s+"-"+t,staticClass:"mx-10",style:{"text-align":"left","overflow-wrap":"break-word"}},[a("v-list-item-content",{staticClass:"mx-0",style:{"text-align":"left","overflow-wrap":"break-word"}},[a("v-list-item-title",{staticClass:"font-weight-bold"},[e._v(e._s(s))]),""!=t[s]&&t[s]?e._e():a("v-list-item-subtitle",{},[e._v("(Empty)")]),"boolean"==e.adjustable[s]["type"]?a("v-switch",{model:{value:t[s],callback:function(a){e.$set(t,s,a)},expression:"sample[key4]"}}):"list"==e.adjustable[s]["type"]?a("v-select",{attrs:{solo:"",items:e.adjustable[s].values,label:"Select","single-line":""},model:{value:t[s],callback:function(a){e.$set(t,s,a)},expression:"sample[key4]"}}):"string"==e.adjustable[s].type?a("v-edit-dialog",{attrs:{"return-value":t[s],large:"",rules:[e.containsPlatform],persistent:""},on:{"update:returnValue":function(a){return e.$set(t,s,a)},"update:return-value":function(a){return e.$set(t,s,a)},save:e.save,cancel:e.cancel,open:e.open,close:e.close},scopedSlots:e._u([{key:"input",fn:function(){return[a("div",{staticClass:"mt-4 text-h6"},[e._v(" Update Value ")]),a("v-text-field",{attrs:{label:"Edit","single-line":"",counter:"",autofocus:""},model:{value:t[s],callback:function(a){e.$set(t,s,a)},expression:"sample[key4]"}})]},proxy:!0}],null,!0)},[a("div",{staticStyle:{display:"flex"}},[a("code",{staticClass:"overflow-auto"},[e._v(e._s(t[s]))]),a("v-spacer",{staticClass:"mx-10"})],1)]):e._e()],1)],1)})),1)})),1)],1)],1),e.dialogQueue?a("v-dialog",{staticStyle:{"overflow-x":"auto",width:"100%"},attrs:{absolute:""},model:{value:e.dialogQueue,callback:function(t){e.dialogQueue=t},expression:"dialogQueue"}},[a("v-card",{staticClass:"mx-auto",staticStyle:{"overflow-y":"auto",width:"100%"},attrs:{outlined:""}},[a("v-list-item",{attrs:{dense:"","three-line":""}},[a("v-list-item-content",{attrs:{dense:""}},[a("div",{},[e.selectedSampleIndex.status.running?a("v-progress-circular",{attrs:{indeterminate:"",color:"primary",size:"15"}}):0==e.selectedSampleIndex.status.success&&e.selectedSampleIndex.status.historical?a("v-tooltip",{attrs:{dark:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-icon",e._g({attrs:{large:"",color:"green",dark:""}},s),[e._v(" mdi-history ")])]}}],null,!1,3653186912)},[e._v(" Already run ")]):0==e.selectedSampleIndex.status.success?a("v-tooltip",{attrs:{dark:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-icon",e._g({attrs:{large:"",color:"green",dark:""}},s),[e._v(" mdi-check-circle ")])]}}],null,!1,2035924251)},[e._v(" Completed Successfully ")]):0!=e.selectedSampleIndex.status.success?a("v-tooltip",{attrs:{dark:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-icon",e._g({attrs:{large:"",color:"orange",dark:""}},s),[e._v(" mdi-exclamation ")])]}}],null,!1,3361264074)},[e._v(" Error in Completing Job, Check Logs ")]):e._e()],1),a("v-list-item-title",{staticClass:"text-h5 mb-1"},[e._v(" "+e._s(e.selectedSampleIndex.name)+" ")]),a("v-list-item-subtitle",[e._v(" "+e._s(e.selectedSampleIndex.filepath)+" ")])],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.dialogQueue=!1}}},[e._v(" Close ")])],1),a("v-card-text",{staticClass:"text-sm-left",staticStyle:{"white-space":"pre-wrap"}},[a("code",{staticClass:"text-sm-left ",staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(e.selectedSampleIndex.command))]),e._l(e.selectedSampleIndex.status.logs,(function(t,s){return a("code",{key:s+"-logQueue",staticStyle:{"white-space":"pre-wrap"}},[e._v(" "+e._s(t)+" "),a("v-divider")],1)}))],2),a("v-divider")],1)],1):e._e(),e.dialogJobs?a("v-dialog",{model:{value:e.dialogJobs,callback:function(t){e.dialogJobs=t},expression:"dialogJobs"}},[a("v-data-iterator",{staticClass:"grey lighten-3",attrs:{items:e.selectedSample,"items-per-page":e.itemsPerPage,page:e.page,search:e.search,"sort-by":e.sortBy.toLowerCase(),"sort-desc":e.sortDesc},on:{"update:itemsPerPage":function(t){e.itemsPerPage=t},"update:items-per-page":function(t){e.itemsPerPage=t},"update:page":function(t){e.page=t}},scopedSlots:e._u([{key:"header",fn:function(){return[a("v-toolbar",{staticClass:"mb-1",attrs:{dark:"",color:"blue darken-3"}},[a("v-btn",{attrs:{small:"",fab:"",color:"grey"},on:{click:function(t){e.dialogJobs=!1}}},[a("v-icon",[e._v("mdi-close")])],1),a("v-spacer"),e.selectedSample?a("v-btn",{attrs:{large:"",depressed:"",color:"blue",value:!1,disabled:e.page*e.itemsPerPage>=e.selectedSample.length},on:{click:function(t){e.page=e.page+1}}},[a("v-icon",[e._v("mdi-arrow-down")])],1):e._e(),a("v-btn",{attrs:{large:"",depressed:"",disabled:e.page<=1,color:"blue",value:!0},on:{click:function(t){e.page>1&&(e.page=e.page-1)}}},[a("v-icon",[e._v("mdi-arrow-up")])],1),a("v-spacer"),a("v-text-field",{attrs:{clearable:"",flat:"","solo-inverted":"","hide-details":"","prepend-inner-icon":"mdi-magnify",label:"Search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e.$vuetify.breakpoint.mdAndUp?[a("v-spacer"),a("v-select",{attrs:{flat:"","solo-inverted":"","hide-details":"",items:e.keys,"prepend-inner-icon":"mdi-magnify",label:"Sort by"},model:{value:e.sortBy,callback:function(t){e.sortBy=t},expression:"sortBy"}}),a("v-spacer")]:e._e()],2)]},proxy:!0},{key:"default",fn:function(t){return[a("v-row",e._l(t.items,(function(t){return a("v-col",{key:t.index+"-sampleIndex-"+t.status.running,attrs:{cols:"12",sm:"6",md:"4",lg:"4"}},[a("v-card",{staticStyle:{"overflow-x":"auto",width:"100%"},attrs:{"max-height":"200px"}},[a("v-card-title",{staticClass:"text-header-2"},[t.status.running?a("v-progress-circular",{key:t.status.running+"-running"+t.sample,attrs:{indeterminate:"",color:"primary",size:"15"}}):0==t.status.success&&t.status.historical?a("v-tooltip",{key:"queueinfo-"+t.status.historical+"-"+t.index,attrs:{dark:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-icon",e._g({attrs:{small:"",color:"green",dark:""}},s),[e._v(" mdi-history ")])]}}],null,!0)},[e._v(" Already run ")]):0==t.status.success?a("v-tooltip",{attrs:{dark:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on,n=t.attrs;return[a("v-icon",e._g({attrs:{small:"",color:"green",dark:"",bind:n}},s),[e._v(" mdi-check-circle ")])]}}],null,!0)},[e._v(" Completed Successfully ")]):t.status.error||0!=t.status.code?a("v-tooltip",{key:"queuerror-"+t.status.error+"-"+t.index,attrs:{color:"orange lighten-1",dark:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on,n=t.attrs;return[a("v-icon",e._g(e._b({attrs:{large:"",color:"orange lighten-1"},on:{click:function(t){e.sheet=!0}}},"v-icon",n,!1),s),[e._v(" mdi-exclamation ")])]}}],null,!0)},[a("span",[e._v(e._s(t.status.error))])]):e._e(),e._v(" "+e._s((t.sample&&t.sample.sample?t.sample.sample:"")+" ")+" "),a("v-spacer"),a("v-tooltip",{attrs:{dark:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(s){var n=s.on;return[a("v-btn",e._g({staticClass:"px-0 mx-0",attrs:{color:"secondary",fab:"",dark:"","x-small":""},on:{click:function(a){e.selectedSampleIndex=t,e.dialogQueue=!0}}},n),[a("v-icon",{attrs:{dark:""}},[e._v(" mdi-tray-full ")])],1)]}}],null,!0)},[e._v(" Information ")]),a("v-tooltip",{key:t.index+"-"+t.name+"-Archivecancel",attrs:{dark:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(s){var n=s.on;return[a("v-btn",e._g({attrs:{disabled:!t.status.running,fab:"","x-small":"",color:"orange lighten-1"},on:{click:function(a){return e.cancelJob(t.index,t.name)}}},n),[a("v-icon",[e._v("mdi-cancel")])],1)]}}],null,!0)},[e._v(" Cancel ")]),a("v-tooltip",{key:t.index+"-"+t.name+"-rerunbutton",attrs:{dark:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(s){var n=s.on,l=s.attrs;return[a("v-btn",e._g(e._b({staticClass:"px-0 mx-0",attrs:{disabled:t.status.running,color:"blue lighten-1",fab:"",dark:"","x-small":""},on:{click:function(a){return e.start(t.index,t.name)}}},"v-btn",l,!1),n),[a("v-icon",[e._v("mdi-play")])],1)]}}],null,!0)},[e._v(" Rerun ")])],1),a("v-card-subtitle",{staticClass:"subheading"},[t.status.running||0!=t.status.success?e._e():a("v-tooltip",{key:t.index+"-"+t.name+"-arhice",attrs:{dark:"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-icon",e._g({attrs:{small:"",color:"secondary lighten-1"}},s),[e._v(" mdi-archive ")])]}}],null,!0)},[e._v(" "+e._s(t.filepath)+" ")]),e._v(" "+e._s((t.sample?t.sample.format:"")+" - "+(t.sample&&t.sample.demux?"Demux":"Classify")+" ")+" . "+e._s(t.index)+" "+e._s(t.sample?t.sample.filepath:"")+" ")],1),a("v-divider"),a("v-list",{attrs:{dense:""}},e._l(e.attributes,(function(s){return a("v-list-item",{key:s+"-formatkey",attrs:{"two-line":""}},[a("v-list-item-content",[a("v-list-item-title",{staticStyle:{"white-space":"normal"}},[e._v(e._s(s))])],1),a("v-divider",{attrs:{vertical:""}}),a("v-list-item-content",{staticClass:"align-end"},[a("v-list-item-subtitle",{staticClass:"mx-3",staticStyle:{"white-space":"normal"}},[e._v(e._s(t.sample[s]))]),a("v-divider")],1)],1)})),1)],1)],1)})),1)]}}],null,!1,2831378809)})],1):e._e(),a("v-snackbar",{attrs:{timeout:3e3,color:e.snackColor},scopedSlots:e._u([{key:"action",fn:function(t){var s=t.attrs;return[a("v-btn",e._b({attrs:{"x-small":"",text:""},on:{click:function(t){e.snack=!1}}},"v-btn",s,!1),[e._v(" Close ")])]}}]),model:{value:e.snack,callback:function(t){e.snack=t},expression:"snack"}},[e._v(" "+e._s(e.snackText)+" ")])],1)},C=[],A=a(6493),T=a.n(A),D=a(6486),$=a.n(D),V=a(5108);a(6470);var P={name:"Samplesheet",props:["samplesheet","samplesheetName","seen","current","logs","bundleconfig","queueList","anyRunning","queueLength","pausedServer"],components:{VueJsonToCsv:T()},updated:function(){const e=this;this.$nextTick((()=>{e.$el.querySelector&&e.$el.querySelector(".logDiv")&&this.scroll&&(this.$el.querySelector(".logDiv").scrollTop=this.$el.querySelector(".logDiv").scrollHeight)}))},watch:{dialog(e){e||this.closeItem()},pausedServer(e){e!=this.paused&&(V.log("server sent paused status change"),this.paused=e)},bundleconfig(e){this.stagedBundleConfig=e},paused(e){this.$emit("pausedChange",e)},queueList(e){V.log(e,"queuelist changed")},stagedData(e){let t=[];for(let[a,s]of Object.entries(e))"columns"!==a&&t.push(s);this.$emit("updateData",t)},name(e){const t=this;let a=new FileReader;async function s(){t.stagedData=await o.ueB(a.result),t.stagedData=t.stagedData.filter((e=>e.sample&&""!=e.sample))}a.addEventListener("load",s,!1),a.readAsText(e)},dialogDelete(e){e||this.closeDelete()},samplesheet(e){this.dataSamples=e},nextPage(){this.page+1<=this.numberOfPages&&(this.page+=1)},formerPage(){this.page-1>=1&&(this.page-=1)},updateItemsPerPage(e){this.itemsPerPage=e}},computed:{numberOfPages(){return Math.ceil(this.selectedSample.length/this.itemsPerPage)},samples(){return this.dataSamples},filteredKeys(){return this.keys.filter((e=>"Name"!==e))},formTitle(){return-1===this.editedIndex?"New Item":"Edit Item"}},data(){return{CSVTITLE:"Mytax2Report",snack:!1,name:null,dialogJobs:!1,singleExpand:!0,expanded:[],scroll:!0,tab:0,page:1,itemsPerPage:9,sortBy:"name",itemsPerPageArray:[9,15,20],search:"",filter:{},sortDesc:!1,dialogAdvanced:!1,dialogQueue:!1,dialogLogs:!1,attributes:["format","platform","database","sample","demux","path_1","path_2"],adjustable:{format:{type:"list",values:["file","directory"]},path_1:{type:"string"},path_2:{type:"string"},demux:{type:"boolean"},compressed:{type:"boolean"},pattern:{type:"string"},kits:{type:"string"},database:{type:"string"},platform:{type:"list",values:["oxford","illumina"]}},tabs:["Script Config for Name mapping","Kraken2 Advanced Config"],advanced:!0,sheet:!1,stagedData:[],config:{},paused:!1,snackColor:"",editedItem:{sample:"",path_1:null,path_2:null,format:null,database:null,kits:null,pattern:"",platform:null},defaultItem:{sample:"",path_1:null,path_2:null,format:null,database:null,platform:null,kits:null,pattern:""},selectedSample:null,selectedSampleIndex:null,dataSamples:[],editedIndex:-1,dialog:!1,dialogDelete:!1,snackText:"",stagedBundleConfig:{},containsPlatform:e=>"oxford"==e||"illumina"==e||"Must be oxford or illumina! (case sensitive)",containsFormat:e=>"fil2e"==e||"directory"==e||"Must be file or directory! (case sensitive)",keys:["sample","filepath"],headers:[{text:"Jobs",value:"jobs",sortable:!1},{text:"",value:"actions",sortable:!1},{text:"Demultiplex",value:"demux",type:"boolean",sortable:!1},{text:"Sample Name",value:"sample",type:"string",sortable:!0},{text:"Path 1",value:"path_1",type:"string",sortable:!0},{text:"Path 2",value:"path_2",type:"string",align:"center",sortable:!0},{text:"Format",value:"format",type:"list",values:["directory","file"],sortable:!0},{text:"Platform",value:"platform",type:"list",value:["oxford","illumina"],align:"center",sortable:!0},{text:"Kraken2 Database",value:"database",sortable:!0,type:"string",cellClass:"text-wrap overflow-auto "},{text:"Compressed (gz)",value:"compressed",type:"boolean",sortable:!1},{text:"Pattern to match barcodes",value:"pattern",type:"string",sortable:!1},{text:"Barcode Kits",value:"kits",type:"string",sortable:!1}]}},async mounted(){this.config["memory-mapping"]=!0,this.config["gzip-compressed"]=!1,this.config["bzip2-compressed"]=!1,this.config["minimum-hit-groups"]=!1,this.config["report-minimizer-data"]=!1,this.config["report-zero-counts"]=!1,this.config["quick"]=!1,this.config["confidence"]=0,this.config["minimum-base-quality"]=0,this.dataSamples=this.samplesheet},methods:{updateConfig(e){this.$emit("updateConfig","bundle"==e?this.stagedBundleConfig:this.config,e)},anyCompleted(e){try{if(this.queueList[e]){let t=this.queueList[e].some((e=>0==e.status.success));return t}return null}catch(t){return V.error(t),null}},start(e,t){this.$emit("rerun",e,t)},barcode(e){this.$emit("barcode",e)},flush(){this.$emit("sendMessage",JSON.stringify({type:"flush"}))},cancelJob(e,t){this.$emit("cancel",{type:"cancelJob",index:e,sample:t})},async forceRestart(e){this.$emit("sendNewWatch",{overwrite:!0,sample:e})},addDropFile(e){this.name=e.dataTransfer.files[0]},save(){this.snack=!0,this.snackColor="success",this.snackText="Data saved"},cancel(){this.snack=!0,this.snackColor="error",this.snackText="Canceled"},open(){this.snack=!0,this.snackColor="info",this.snackText="Dialog opened"},close(){V.log("Dialog closed")},deleteItem(e){this.editedIndex=this.dataSamples.indexOf(e),this.editedItem=Object.assign({},e),this.dialogDelete=!0},deleteItemConfirm(){let e=this.dataSamples[this.editedIndex];this.dataSamples.splice(this.editedIndex,1),this.closeDelete(),e&&e.sample&&this.$emit("deleteRow",e.sample)},editItem(e){this.editedIndex=$().cloneDeep(this.dataSamples.indexOf(e)),this.editedItem=Object.assign({},e),this.dialog=!0},closeItem(){this.dialog=!1,this.$nextTick((()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1}))},closeDelete(){this.dialogDelete=!1,this.$nextTick((()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1}))},saveItem(){this.editedIndex>-1?(Object.assign(this.dataSamples[this.editedIndex],this.editedItem),this.$set(this.dataSamples,this.editedIndex,this.editedItem)):this.dataSamples.push(this.editedItem),this.closeItem()}}},Z=P,I=a(3694),L=a(3272),N=a(4562),R=a(9582),O=a(4886),j=a(3486),z=a(8077),B=a(4061),E=a(9223),M=a(5130),F=a(1625),q=a(4324),W=a(5808),J=a(7397),U=a(4525),H=a(5187),Y=a(9471),K=a(3305),Q=a(7423),G=a(9258),X=a(9884),ee=a(626),te=a(2165),ae=a(8263),se=a(5085),ne=a(1475),le=a(6313),ie=a(2082),re=(0,u.Z)(Z,w,C,!1,null,null,null),oe=re.exports;p()(re,{VAlert:I.Z,VBadge:L.Z,VBtn:N.Z,VCard:R.Z,VCardActions:O.h7,VCardSubtitle:O.Qq,VCardText:O.ZB,VCardTitle:O.EB,VCheckbox:j.Z,VCol:h.Z,VContainer:f.Z,VDataIterator:z.Z,VDialog:B.Z,VDivider:E.Z,VEditDialog:M.Z,VFileInput:F.Z,VIcon:q.Z,VList:W.Z,VListGroup:J.Z,VListItem:U.Z,VListItemAction:H.Z,VListItemContent:Y.km,VListItemSubtitle:Y.oZ,VListItemTitle:Y.V9,VProgressCircular:K.Z,VRow:g.Z,VSelect:v.Z,VSheet:Q.Z,VSnackbar:G.Z,VSpacer:x.Z,VSwitch:X.Z,VTab:ee.Z,VTabItem:te.Z,VTabs:ae.Z,VTabsItems:se.Z,VTabsSlider:ne.Z,VTextField:b.Z,VToolbar:le.Z,VToolbarTitle:y.qW,VTooltip:ie.Z});var de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-row",[a("v-col",{attrs:{sm:"12"}},[a("v-toolbar",{attrs:{extended:"",dark:""},scopedSlots:e._u([{key:"extension",fn:function(){return[a("v-tabs",{attrs:{"align-with-title":"",color:"basil"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tabs-slider",{attrs:{color:"purple"}}),e._l(e.tabs,(function(t,s){return a("v-tab",{key:s+"-tab"},[a("v-icon",{staticClass:"mr-2"},[e._v(" mdi-"+e._s(t.icon)+" ")]),e._v(" "+e._s(t.name)+" ")],1)}))],2),1==e.tab||2==e.tab?a("v-select",{key:e.legendPlacement,staticStyle:{"padding-top":"50px"},attrs:{items:e.legendPlacements,color:"white",width:"5px",label:"Legend Placement Position"},model:{value:e.legendPlacement,callback:function(t){e.legendPlacement=t},expression:"legendPlacement"}}):e._e(),a("v-select",{key:e.selectedAttribute,staticStyle:{"padding-top":"50px"},attrs:{items:e.ranks,color:"white",width:"5px","item-text":"name","item-value":"name","return-object":"",label:"Update Legend rank"},on:{input:function(t){e.full=!0}},model:{value:e.selectedAttribute,callback:function(t){e.selectedAttribute=t},expression:"selectedAttribute"}}),a("v-select",{key:"selectednameattr",staticStyle:{"padding-top":"50px"},attrs:{items:Object.keys(e.namesData),color:"white",width:"5px","persistent-hint":"",hint:"Change Name Display Type",label:"Name Type"},model:{value:e.selectedNameAttr,callback:function(t){e.selectedNameAttr=t},expression:"selectedNameAttr"}})]},proxy:!0}])},[a("v-toolbar-title",[e._v("Sample Reports")]),a("v-spacer"),a("v-spacer"),1==e.tab?a("v-autocomplete",{key:"selectsearchcomplete",staticStyle:{"padding-top":"50px"},attrs:{items:Object.values(e.selectedsamplesList),color:"white",width:"5px","item-text":"full","return-object":"",label:"Search Name"},on:{change:function(t){return e.updateSelected(t)}},model:{value:e.selectedName,callback:function(t){e.selectedName=t},expression:"selectedName"}}):e._e(),1==e.tab?a("v-btn",{staticClass:"mb-1 mr-7",attrs:{"icon-and-text":"",small:"",type:"info"},on:{click:function(t){e.selectedTaxid=-1}}},[e._v(" Reset "),a("v-icon",[e._v("mdi-recycle ")])],1):e._e(),a("v-spacer"),a("download-excel",{key:e.fullArray.length+"-downloadexcel",staticStyle:{cursor:"pointer"},attrs:{data:e.fullArray}},[a("v-icon",[e._v("mdi-download")]),e._v("Download ")],1)],1),a("v-tabs-items",{model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},e._l(e.tabs,(function(t,s){return a("v-tab-item",{key:s+"-tabItem"},["Datatable"==t.component?a("v-row",[a("Datatable",{attrs:{selectedAttribute:e.selectedAttribute,selectedTaxid:e.selectedTaxid,samplenames:e.selectedsamples,dimensions:e.dimensions,legendPlacement:e.legendPlacement,inputdata:e.fullArray,socket:e.socket},on:{jumpTo:e.jumpTo}})],1):"Plates"!==t.component&&"Datatable"!==t.components?a("v-row",e._l(Object.entries(e.sampleData),(function(s){var n=s[0],l=s[1];return a("v-col",{key:n+"-sample",attrs:{sm:e.determineSize}},[l?a(t.component,{tag:"component",attrs:{samplename:n,namesData:e.namesData,selectedNameAttr:e.selectedNameAttr,selectedAttribute:e.selectedAttribute,full:e.full,taxa:e.taxa,selectedTaxid:e.selectedTaxid,dimensions:e.dimensions,legendPlacement:e.legendPlacement,inputdata:l,socket:e.socket},on:{jumpTo:e.jumpTo,changeAttribute:e.changeAttribute}}):e._e()],1)})),1):a("v-row",[a("Plates",{attrs:{selectedAttribute:e.selectedAttribute,selectedTaxid:e.selectedTaxid,selectedNameAttr:e.selectedNameAttr,samplenames:e.selectedsamples,dimensions:e.dimensions,legendPlacement:e.legendPlacement,inputdata:e.sampleData,socket:e.socket},on:{jumpTo:e.jumpTo}})],1)],1)})),1)],1)],1)],1)},ce=[],ue=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{ref:"boxContainer",staticStyle:{"padding-top":"10px",width:"97%"}},[a("v-row",[a("v-col",{attrs:{sm:"2"}},[e.samplename?a("v-subheader",[e._v(e._s(e.samplename)+" ")]):e._e(),a("v-divider"),a("br"),a("v-select",{attrs:{items:e.options,dense:"",light:"","item-text":"name","return-object":"",label:"Color by"},model:{value:e.edgeColor,callback:function(t){e.edgeColor=t},expression:"edgeColor"}}),a("v-select",{attrs:{items:e.align_options,dense:"",light:"","item-text":"label","item-value":"value","return-object":"",label:"Align Type"},model:{value:e.aligned,callback:function(t){e.aligned=t},expression:"aligned"}}),a("v-text-field",{attrs:{hint:"Expand Sankey Width","persistent-hint":"","single-line":"",type:"number"},model:{value:e.width,callback:function(t){e.width=t},expression:"width"}}),a("v-spacer",{staticClass:"mt-4"}),a("v-btn",{staticClass:"info",on:{click:function(t){return e.reset()}}},[e._v("Reset ")])],1),a("v-col",{attrs:{sm:"10"}},[a("div",{staticStyle:{"overflow-x":"auto"},attrs:{id:"sankeyBox-"+e.samplename}}),a("v-range-slider",{attrs:{hint:"Range of Ranks to Show",min:e.maxRange[0]-1,max:e.maxRange[1],"persistent-hint":""},on:{change:function(t){return e.hideLabels()}},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("v-text-field",{staticClass:"mt-0 pt-0",staticStyle:{width:"60px"},attrs:{value:e.rangeLabelDepth[0],"hide-details":"","single-line":"",label:"Node Label Shown",type:"number"},on:{change:function(t){return e.$set(e.rangeLabelDepth,0,t)}}})]},proxy:!0},{key:"append",fn:function(){return[a("v-text-field",{staticClass:"mt-0 pt-0",staticStyle:{width:"60px"},attrs:{value:e.rangeLabelDepth[1],"hide-details":"","single-line":"",type:"number"},on:{change:function(t){return e.$set(e.rangeLabelDepth,1,t)}}})]},proxy:!0}]),model:{value:e.rangeLabelDepth,callback:function(t){e.rangeLabelDepth=t},expression:"rangeLabelDepth"}})],1)],1)],1)},me=[],pe=a(7929),he=a(6389),fe=a(4091),ge={name:"RunStats",props:["inputdata","socket","samplename"],watch:{inputdata:{deep:!0,handler(e){e&&(this.removeSankeychart(),this.Sankeychart(e))}},edgeColor(){this.colorLinks()},aligned(){this.removeSankeychart(),this.Sankeychart(this.inputdata)}},data(){return{xAxis:null,dimensions:{windowHeight:0,windowWidth:0,height:0,width:0},yAxis:null,yAxisScale:null,color:o.PKp(o.Cn1),edgeColor:"default",graph:null,sankey:null,depths:{},filteredData:[],rangeLabelDepth:[0,10],maxRange:[0,10],align_options:[{label:"Left align",target:pe.t$,value:"left"},{label:"Right align",target:pe.F2,value:"right"},{label:"Center align",target:pe.be,value:"center"},{label:"Justify align",target:pe.PT,value:"justify"}],aligned:{label:"Left align",target:pe.t$,value:"left"},width:1e3,options:["path","input","default"]}},computed:{height(){return this.dimensions.height?this.dimensions.height:300}},async mounted(){this.dimensions.windowHeight=window.innerHeight,this.dimensions.windowWidth=window.innerWidth,this.dimensions.height=.75*this.$refs.boxContainer.clientHeight,this.dimensions.width=.6*this.$refs.boxContainer.clientWidth,this.Sankeychart(this.inputdata)},methods:{reset(){this.removeSankeychart(),this.Sankeychart(this.inputdata)},hideLabels(){o.Ys(`#sankeyBox-${this.samplename}`);this.updateSankey()},colorLinks(){let e=o.Ys(`#sankeyBox-${this.samplename}`),t=e.selectAll(".link");if(t.attr("stroke",(e=>"none"===this.edgeColor?"#aaa":"path"===this.edgeColor?e.uid:"input"===this.edgeColor?this.color(e.source):this.color(e.target))),"path"===this.edgeColor){const e=t.append("linearGradient").attr("id",((e,t)=>`${t}`)).attr("class","gradient").attr("gradientUnits","userSpaceOnUse").attr("x1",(e=>e.source.x1)).attr("x2",(e=>e.target.x0));e.append("stop").attr("offset","0%").attr("stop-color",(e=>this.color(e.source))),e.append("stop").attr("offset","100%").attr("stop-color",(e=>this.color(e.target)))}else e.selectAll(".gradient").remove()},removeSankeychart(){o.Ys("#sankeyBox-"+this.samplename).selectAll("*").remove()},updateSankey(){const e=this;let t=function(e){return r(e)},a=this.sankey,s=this.inputdata.filter((t=>t.parenttaxid>=0&&t.parenttaxid&&1+t.depth/2>=e.rangeLabelDepth[0]&&1+t.depth/2<=e.rangeLabelDepth[1]));var n={top:50,right:20,bottom:30,left:10},l=this.height-n.top-n.bottom;let i=this.width/(1/(e.rangeLabelDepth[1]-e.rangeLabelDepth[0]))-n.left-n.right;var r=o.WUZ(",.0f");let d=_.cloneDeep(e.sankeydata);s.forEach((function(e){d.nodes.push({name:`${e.source}-${e.parenttaxid}`}),d.nodes.push({name:`${e.target}-${e.taxid}`}),d.links.push({source:`${e.source}-${e.parenttaxid}`,target:`${e.target}-${e.taxid}`,value:+e.value})})),d.nodes=Array.from(o.ruo(d.nodes,(t=>(e.depths[t.name]=t.depth,t.name))),(([e])=>e)),d.links.forEach((function(e,t){d.links[t].source=d.nodes.indexOf(d.links[t].source),d.links[t].target=d.nodes.indexOf(d.links[t].target)})),d.nodes.forEach((function(e,t){d.nodes[t]={name:e}}));let c=a(d),u=c.nodes,m=c.links;function p(e,t){t.__x=e.x,t.__y=e.y,t.__x0=t.x0,t.__y0=t.y0,t.__x1=t.x1,t.__y1=t.y1}const h=u[0].x1-u[0].x0;function f(t){o.Ys(this).attr("transform",(function(e){const a=t.x-e.__x,s=t.y-e.__y;return e.x0=e.__x0+a,e.x1=e.__x1+a,e.y0=e.__y0+s,e.y1=e.__y1+s,e.x0<0&&(e.x0=0,e.x1=h),e.x1>i&&(e.x0=i-h,e.x1=i),e.y0<0&&(e.y0=0,e.y1=e.__y1-e.__y0),e.y1>l&&(e.y0=l-(e.__y1-e.__y0),e.y1=l),`translate(${e.x0}, ${e.y0})`})),e.sankey.update({nodes:u,links:m}),g.selectAll(".link").attr("d",(0,he.Z)())}this.svg.selectAll(".nodeSankey").remove(),this.svg.selectAll(".link").remove();this.svg.selectAll("g.nodeSankey").data(u,(e=>e)).join((function(a){let s=a.append("g").attr("class","nodeSankey").attr("transform",(e=>`translate(${e.x0}, ${e.y0})`));return s.append("rect").attr("height",(e=>e.y1-e.y0)).attr("width",(e=>e.x1-e.x0)).attr("fill",e.color).attr("id",((e,t)=>`${e.name}.${t}-rect`)).attr("stroke","#000").append("title").text((e=>`${e.name}\n${t(e.value)}`)),s.append("text").classed("nodeText",!0).attr("font-family","sans-serif").attr("font-size",15).attr("x",(e=>e.x0<i/2?e.x1-e.x0+6:-6)).attr("y",((e,t)=>t%3==1?(e.y1-e.y0)/1.5:t%3==2?(e.y1-e.y0)/3:(e.y1-e.y0)/2)).attr("dy","0.35em").attr("text-anchor",(e=>e.x0<i/2?"start":"end")).text((e=>e.name.split("-")[0])),s.append("text").classed("nodeText",!0).attr("font-family","sans-serif").attr("font-size",15).attr("dy","-0.2em").attr("text-anchor","start").text((e=>Math.round(100*(e.value+Number.EPSILON))/100)),s.attr("cursor","move").call(o.ohM().on("start",p).on("drag",f)),s}),(function(e){return e.selectAll(".nodeSankey").attr("transform",(e=>`translate(${e.x0}, ${e.y0})`)),e}),(function(e){return e.remove()}));const g=this.svg.selectAll(".link").data(m,(e=>e)).join((function(a){let s=a.append("g").attr("fill","none").attr("stroke-opacity",.7).style("mix-blend-mode","multiply");return s.append("path").attr("class","link").attr("d",(0,he.Z)()).attr("stroke-width",(e=>Math.max(1,e.width))),s.append("title").text((function(e){return e.source.name+" → "+e.target.name+"\n"+t(e.value)})),e.colorLinks(),s}),(function(e){return e.selectAll(".link").attr("d",(0,he.Z)()),e}),(function(e){return e.remove()}))},async Sankeychart(e){var t={top:50,right:20,bottom:30,left:10},a=this.width-t.left-t.right,s=this.height-t.top-t.bottom;let n=o.Ys("#sankeyBox-"+this.samplename),l=o.sPX().scaleExtent([0,5]).on("zoom",c);var i=n.append("svg").attr("width",a+t.left+t.right).attr("height",s+t.top+t.bottom).call(l).append("g").attr("transform","translate("+t.left+","+t.top+")"),r=(0,fe.Z)().nodeWidth(10).nodePadding(40).size([a,s]).nodeAlign(this.aligned.target);this.svg=i,this.sankey=r;let d={nodes:[],links:[]};function c(e){return i.attr("transform",e.transform)}this.sankeydata=d,this.maxRange=o.Wem(this.inputdata,(e=>1+e.depth/2)),this.updateSankey()}}},ve=ge,xe=a(2199),be=a(2540),ye=(0,u.Z)(ve,ue,me,!1,null,null,null),_e=ye.exports;p()(ye,{VBtn:N.Z,VCol:h.Z,VContainer:f.Z,VDivider:E.Z,VRangeSlider:xe.Z,VRow:g.Z,VSelect:v.Z,VSpacer:x.Z,VSubheader:be.Z,VTextField:b.Z});var ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-row",{ref:"boxContainer"},[a("v-subheader",[e._v(e._s(e.samplename)+" ")]),e.inputdata?a("v-data-table",{staticClass:"elevation-1 mx-5 px-6",attrs:{small:"",items:e.inputdata,height:e.dimensions.height,headers:e.headers,"items-per-page":100,search:e.search,"custom-filter":e.filter,width:1e3},scopedSlots:e._u([{key:"item.extract",fn:function(t){var s=t.item;return[a("v-btn",{staticClass:"mr-2",attrs:{"x-small":"",color:"grey"},on:{click:function(t){return e.extractTaxid(s.taxid)}}},[e._v(" Extract Taxid ")])]}},{key:"top",fn:function(){return[a("v-toolbar",[a("v-toolbar-title",{staticClass:"mr-10"},[e._v("Classifications")]),a("v-select",{attrs:{items:e.headers,"persistent-hint":"",hint:"Column to search on"},model:{value:e.selectedSearch,callback:function(t){e.selectedSearch=t},expression:"selectedSearch"}}),a("v-text-field",{staticClass:"mx-4",attrs:{label:"Search ",placeholder:"Search Term"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)]},proxy:!0}],null,!0)}):e._e()],1)},Se=[],we=a(5108),Ce={name:"RunStats",props:["inputdata","socket","samplename"],watch:{},data(){return{nodeCountMax:0,edgeColor:"default",dimensions:{windowHeight:0,windowWidth:0,height:0,width:0},options:["path","input","default"],headers:[{text:"Sample",value:"samplename",align:"center",sortable:!0},{text:"Percent",value:"value",sortable:!0,align:"center"},{text:"Parent",value:"source",align:"center",sortable:!0},{text:"Scientific Name",value:"target",align:"center",sortable:!0},{text:"Depth",value:"depth",align:"center",sortable:!0},{text:"Fragments In Clade",value:"num_fragments_clade",align:"center",sortable:!0},{text:"TaxID",value:"taxid",align:"center",sortable:!0},{text:"Fragments Assigned",value:"num_fragments_assigned",align:"center",sortable:!0},{text:"Fullname",value:"full",align:"center",sortable:!0},{text:"Rank Code",align:"center",value:"rank_code",sortable:!0}],search:null,selectedSearch:{text:"Name",value:"target",align:"center",sortable:!0}}},async mounted(){this.dimensions.windowHeight=window.innerHeight,this.dimensions.windowWidth=window.innerWidth,this.dimensions.height=2*this.$refs.boxContainer.clientHeight,this.dimensions.width=.6*this.$refs.boxContainer.clientWidth},methods:{sendMessage:async function(e){if(this.socket.readyState!==this.socket.OPEN)try{await this.waitForOpenConnection(this.socket),this.socket.send(e)}catch(t){we.error(t)}else this.socket.send(e)},extractTaxid(e){this.sendMessage(JSON.stringify({type:"extractTaxid",taxid:e}))},filter(e,t,a){var s=`.*${t}.*`,n=new RegExp(s,"ig");return!!n.test(a[this.selectedSearch])}}},Ae=Ce,Te=a(5039),De=(0,u.Z)(Ae,ke,Se,!1,null,null,null),$e=De.exports;p()(De,{VBtn:N.Z,VDataTable:Te.Z,VRow:g.Z,VSelect:v.Z,VSubheader:be.Z,VTextField:b.Z,VToolbar:le.Z,VToolbarTitle:y.qW});var Ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{ref:"boxContainer",staticStyle:{"padding-top":"10px"}},[a("v-row",[a("v-col",{staticClass:"mb-0; pb-0",staticStyle:{"padding-top":"10px","padding-bottom":"100px"},attrs:{sm:"bottom"==e.legendPlacement?12:8}},[a("div",{attrs:{id:"sunburstDiv-"+e.samplename}})]),a("v-col",{staticClass:"mt-0; pt-0 text-center",attrs:{sm:"bottom"==e.legendPlacement?12:4}},[a("div",{staticClass:"mt-5",staticStyle:{margin:"auto","padding-bottom":"10px"},attrs:{id:"legend_text-"+e.samplename}},[a("h5",[e._v("Legend")]),a("h6",[e._v("Total Reads "+e._s(e.readCount))]),a("h6",[e._v("at Rank Code: "+e._s(e.selectedAttribute))]),a("span",{staticStyle:{"text-align":"center"},attrs:{id:"legend_text_label-"+e.samplename}}),"Deviation"==e.selectedAttribute?a("div",{staticClass:"alert alert-info"},[a("span",[e._v("Color is Relative to +/- Max Abundance at a Given Rank")])]):e._e()]),a("div",{staticStyle:{position:"relative",background:"none","padding-bottom":"100px","background-opacity":"0.5",width:"100%","max-height":"200px","overflow-y":"auto","overflow-x":"auto"},attrs:{id:"legend_wrapper-"+e.samplename}})])],1)],1)},Pe=[],Ze={name:"RunStats",props:["inputdata","namesData","selectedNameAttr","full","taxa","socket","samplename","selectedTaxid","selectedAttribute","legendPlacement"],watch:{selectedNameAttr(e){this.updateText()},namesData:{deep:!0,handler(e){}},full(){this.madeFirst&&(this.updateColors(),this.inputdata&&this.updateLegendTax())},selectedTaxid(e){let t=o.Ys("#sunburstDiv-"+this.samplename).select(this.fetchArc("#sliceMain",e)),a=t.data()[0];t.empty()||(this.$emit("changeAttribute",a.data.data.rank_code),this.focusOn(a),this.madeFirst&&(this.updateColors(),this.updateLegendTax()))},inputdata(e){this.madeFirst?this.mergeData(e):this.makeSunburst(e)},selectedAttribute:{deep:!0,handler(){this.inputdata&&(this.getTaxValues(),this.updateColors(),this.updateLegendTax())}}},computed:{readCount(){let e=0;return this.inputdata.filter((e=>e.rank_code==this.selectedAttribute)).map((t=>t.num_fragments_clade?e+=t.num_fragments_clade:"")),e},width(){return this.dimensions.width?this.dimensions.width:window.innerWidth?window.innerWidth:400},height(){return this.dimensions.height?this.dimensions.height:900}},data(){return{test:.5,taxData:null,taxValues:[],childrenselected:0,history:{},recursedata:null,Extent:[],ranks:[],madeFirst:!1,maxAbu:1e8,minAbu:1e-4,resetUpdateChecked:!0,dimensions:{windowHeight:0,windowWidth:0,height:0,width:0},abuThresholdMin:0,defaultAbuThresholdMin:1e-4,abuThresholdMax:1,defaultAbuThresholdMax:1,ranksizeExtents:{},seen:{},originalsizeBasis:!1,scaleModes:[{name:"totalsize",label:"Total size"},{name:"originalsize",label:"Original size"}],selected_scaleMode:{name:"totalsize",label:"Total size"},selected_classifier:null,rankNames:[],fullData:[],calculateAbu:!0,zoomed:null,radius:0,maxRanks:0,read_type:null,boundsLegendDeviation:{lower:-1,upper:1},boundsDeviation:{},childrenTaxes:[],firstReady:!1,tab:1,shown:!1,fields:[{key:"name",label:"Name",sortable:!0,class:"text-center"},{key:"taxid",label:"TaxID",sortable:!0,class:"text-center"},{key:"rank",label:"Rank",sortable:!0,class:"text-center"},{key:"totalabu",label:"Reported Abu",sortable:!0}],filterOn:[],sortBy:"originalsize",defaultColor:"#1f77b4",colorScalePiechart:o.Cn1.slice(1),colorScaleDeviationPieChart:o.DeQ,x:null,taxes:[],y:null,arc:null,sortDir:{col:null,direction:null},middleArcLine:null,colorRampPieChart:null,colorDeviationPieChart:null,root:null}},methods:{getTaxValues(){let e=[];return this.inputdata.map((t=>{-1==e.indexOf(t.target)&&t.rank_code==this.selectedAttribute&&e.push({label:t.target,taxid:t.taxid,rank_code:t.rank_code,abu:t.value,text:this.getText(t),num_fragments_clade:t.num_fragments_clade})})),e},mergeData(e){let t=o.Fp7(e,(e=>e.depth));if(t!==this.maxDepth){let t=this.stratify(e);this.root=this.partition(t),this.updateSunburst(this.root)}else{let t=this.stratify(e);this.root=this.partition(t),this.updateSunburst(this.root)}},updateLegendTax(){let e=this,t=o.Cn1[0];this.emptyColor=o.Cn1[0];let a=this.selectedAttribute;const s=this.defaultColor;let n=this.getTaxValues();const l=o.Ys("#legendSVG-"+this.samplename).classed("svgPieChartLegend",!0);let i=o.Ys(`#legend_wrapper-${this.samplename}`),r=o.Ys(`#legend_text_label-${this.samplename}`);r.text("Rank: "+a),r.text("Sample: "+this.samplename),i.style("overflow-y","auto").style("overflow-x","auto"),l.selectAll(".legendElement").remove();let d=this.childrenTaxes;var c;let u=this.full;if(u)c=l.selectAll("g.legendElement").data(n);else{let e=d.filter((e=>this.taxa.indexOf(e.label)>-1));c=0==e.length?l.selectAll("g.legendElement").data(n.sort(((e,t)=>t.abu-e.abu))):l.selectAll("g.legendElement").data(e.sort(((e,t)=>t.abu-e.abu)))}c&&c._enter.length>0&&c.exit().remove();var m=c.enter().append("g");m.attr("class","legendElement").sort(((e,t)=>e.abu-t.abu)).on("click",(function(t,a){e.jumpTo(a.taxid,a.rank_code)})).attr("id",(t=>"legendElement-"+e.samplename+t.taxid)),m.append("rect").attr("x",0).attr("y",0).attr("width",25).attr("height",25).attr("class","legendRect").style("fill",s),m.append("text").attr("x",35).attr("y",18).style("font-size","14px");var p=c.merge(m).transition().duration(0).attr("transform",(function(e,t){return"translate(0,"+30*t+")"}));p.selectAll("rect").style("fill",(function(a){var n=s;return""==a?n=t:a&&(n=e.colorRampPieChart(a.label)),n})),p.selectAll("text").text((function(t){var s=t.label;""==s&&(s="No "+a+" listed");const n=t.abu;return t.text+" ("+e.roundNumbers(n,3)+"%) "+`(${t.num_fragments_clade} fragments classified) taxid: ${t.taxid}`})),l.attr("height",30*m.size())},getText(e){const t=this;return t.selectedNameAttr?"default (scientific name)"==t.selectedNameAttr?e.target:e.objfull&&e.objfull[t.selectedNameAttr]&&e.objfull[t.selectedNameAttr].length>0?e.objfull[t.selectedNameAttr][0]:e.target:e.target},updateText(){const e=this;this.svg.selectAll(".textfull").remove();let t=this.svg.selectAll(".slice"),a=t.append("text").classed("textfull",!0).attr("display",(t=>e.textFits(t)?null:"none")).style("fill","#484848");a.append("textPath").classed("whitecontour",!0).attr("startOffset","50%").attr("xlink:href",(t=>`#hiddenArc${t.data.data.taxid}-${e.samplename}`)).text((t=>e.getText(t.data.data))).style("font-size","10px").style("stroke","#fff").style("stroke-width",2.5).style("stroke-linejoin","round").attr("dominant-baseline","middle"),a.append("textPath").classed("hiddentext",!0).attr("startOffset","50%").attr("xlink:href",(t=>`#hiddenArc${t.data.data.taxid}-${e.samplename}`)).text((t=>e.getText(t.data.data))).style("font-size","10px").attr("dominant-baseline","middle"),this.updateLegendTax()},updateColors(){let e=this.svg,t=o.PKp(this.colorScalePiechart).domain(this.taxa);this.colorRampPieChart=t;const a=this.colorSlice;e&&e.selectAll(".main-arc").style("fill",(function(e){return a(e)}))},clearSunburst(){return new Promise((e=>{o.Ys("#sunburstDiv-"+this.samplename).html(""),e()}))},resetSunburst(){this.jumpTo(-1,"base"),this.zoomed=null},jumpTo(e,t){this.$emit("jumpTo",e,t)},fetchArc(e,t){return e+"-"+this.samplename+"-"+t},updateSunburst(e){const t=this,a=this.svg,s=this.maxRadius,n=this.height,l=this.x,i=this.y;a.attr("viewBox",`${-s} ${-n/2} ${2*s} ${n}`);const r=this.width/this.maxRanks;this.radius=r;const d=e=>{const t=Math.PI/2,a=[l(e.x0)-t,l(e.x1)-t],s=Math.max(0,(i(e.y0)+i(e.y1))/2),n=(a[1]+a[0])/2,r=n>0&&n<Math.PI;r&&a.reverse();const d=o.ETc();return d.arc(0,0,s,a[0],a[1],r),d.toString()};this.middleArcLine=d;let c=[];const u=a.select(".globalg");let m=0,p=e.descendants().filter((function(e){const a=t.fetchArc("sliceMain",e.data.data.taxid);let s=e.data.data;return c.push({rank:s.rank_code,taxid:s.taxid,id:a,name:s.target,totalabu:s.num_fragments_clade,originalsize:s.num_fragments_clade,text:t.getText(s),label:s.rank_code+" "+s.target+" "+s.taxid}),e.data.totalabu=s.num_fragments_clade,e.data.label=s.rank_code+" "+s.target+" "+s.taxid,e.data.id=t.fetchArc("sliceMain",s.taxid,s.depth),s.totalsize>m&&(m=s.num_fragments_clade),!0}));const h=a.transition().duration(750).tween("scale",(()=>{const e=o.sXR(l.domain(),[0,1]),t=o.sXR(i.domain(),[0,1]);return a=>{l.domain(e(a)),i.domain(t(a))}}));h.selectAll("path.main-arc").attrTween("d",(e=>()=>this.arc(e))),h.selectAll("path.hidden-arc").attrTween("d",(e=>{d(e)})),h.selectAll("text").attrTween("display",(e=>()=>t.textFits(e)?null:"none"));const f=this.arc;let g={};const v=this.colorSlice;function x(){const{transform:e}=o.event;u.attr("transform",e),u.attr("stroke-width",1/e.k)}u.selectAll("g.slice").data(p,(e=>(g[e.data.label]?(g[e.data.label].x0=e.x0,g[e.data.label].y0=e.y0,g[e.data.label].x1=e.x1,g[e.data.label].y1=e.y1):g[e.data.label]=e,`${e.data.label}-${e.data.data.num_fragments_clade}`))).join((function(e){let a=e.append("g").attr("class","slice").on("click",(function(e,a){e.stopPropagation(),t.$emit("jumpTo",a.data.data.taxid,a.data.data.rank_code)})).attr("id",(e=>t.fetchArc("slice",e.data.data.taxid)));return a.append("title").text((function(e){return"Sample: "+t.samplename+"\nFull Name(s): "+e.data.data.full+"\nName: "+e.data.data.target+"\nPercent: "+e.data.data.value+"%\nDepth: "+e.data.depth+"\nTotal reads: "+t.roundNumbers(e.data.data.num_fragments_clade,0)+"\nAssigned reads: "+t.roundNumbers(e.data.data.num_fragments_assigned,0)+"\nRank: "+e.data.data.rank_code+"\nTaxid: "+e.data.data.taxid})),a.append("path").attr("class","hidden-arc").attr("id",(e=>`hiddenArc${e.data.data.taxid}-${t.samplename}`)).attr("d",(e=>d(e))),a.append("path").attr("class","main-arc").style("fill",(function(e){return v(e)})).attr("d",(e=>f(e))).attr("id",(e=>{const a=t.fetchArc("sliceMain",e.data.data.taxid,e.data.data.depth);return a})).style("fill","#ccc").on("mouseover",(function(e,a){var s=o.Ys(t.fetchArc("#sliceMain",a.data.data.taxid,a.data.data.depth));s.style("fill-opacity",.5)})).on("mouseout",(function(e,a){var s=o.Ys(t.fetchArc("#sliceMain",a.data.data.taxid,a.data.data.depth));s.style("fill-opacity",1)})),a}),(function(e){return e.selectAll(".main-arc").each((e=>{e.x0=g[e.data.label].x0,e.x1=g[e.data.label].x1,e.y0=g[e.data.label].y0,e.y1=g[e.data.label].y1})).style("fill",(function(e){return v(e)})).transition().call(t.standardTransition),e.selectAll(".hidden-arc").attr("d",(e=>(e.x0=g[e.data.label].x0,e.x1=g[e.data.label].x1,e.y0=g[e.data.label].y0,e.y1=g[e.data.label].y1,d(e)))),e}),(function(e){return e.remove()})),this.updateText(),o.sPX().scaleExtent([1,8]).on("zoom",x),this.updateColors(),this.updateLegendTax()},async makeSunburst(e){let t=o.Ys("#sunburstDiv-"+this.samplename),a=o.Ys(`#legend_wrapper-${this.samplename}`);t.select("svg").remove(),t.select("#legendSVG-"+this.samplename).remove(),a.html(""),a.append("svg").attr("id","legendSVG-"+this.samplename);const s=this.height,n=Math.round(s/2);this.maxRadius=n;let l=t.append("svg").style("max-width",2*n).style("max-height",this.height).attr("id","sunburst-"+this.samplename);this.svg=l,l.selectAll(".slice").remove(),l.selectAll(".legendElement").remove(),t.style("width",2*n),l.append("g").attr("class","globalg");const i=this;setTimeout((()=>{i.startSunburst(e),this.madeFirst=!0}),100)},stratify(e){return o.QP8().id((e=>e.taxid)).parentId((e=>e.parenttaxid))(e)},startSunburst(e){this.childrenSelected=0;let t=this.stratify(e),a=[];this.taxValues=[],this.taxValues=a;const s=this.partition(t);this.minAbu=this.defaultAbuThresholdMin,this.maxAbu=this.defaultAbuThresholdMax,this.ranks=[];const n=o.BYU().range([0,2*Math.PI]).clamp(!0);this.x=n;const l=this.maxRadius,i=o.PUr().range([.05*l,l]);this.y=i,this.updateColors(),this.updateSunburst(s),this.firstReady=!0},roundNumbers(e,t){return parseFloat(e).toFixed(t)},colorSlice(e){const t=this.colorRampPieChart;let a=this.selectedAttribute;const s=this.defaultColor;var n=e,l=s;if(null!==n&&n.data.data.taxid>0)if(n.data.data.rank_code==a)l=t(e.data.data.target);else{let s=!1,n=e.parent;while(n.depth>0&&0==s)n.data.data.rank_code==a&&(l=t(n.data.data.target),s=!0),n=n.parent}return l},standardTransition(e){e.duration(5e3).ease(o.Nyw)},partition(e){const t=o.bT9(e),a=this;this.seen={};let s=0,n=[],l={};this.taxValues=this.getTaxValues(),t.sum((function(e){let t=e.data;if(t.taxid=parseInt(t.taxid),-1==a.taxes.findIndex((e=>e.rank_code===t.rank_code))&&a.taxes.push({name:t.rank_code}),e.children&&e.children.length>0){t.size=null;let a=0;e.children.forEach((e=>{let t=e.data;a+=(e.children&&e.children.length,t.num_fragments_clade)})),t.size=t.num_fragments_clade-a}else t.size=t.num_fragments_clade;return t.totalsize=t.size,t.originalsize=0,a.seen[t.taxid]=1,t.size})),t.sort(((e,t)=>t.taxid-e.taxid)),t.each((e=>{e.data.depth>this.maxRanks&&(this.maxRanks=e.data.depth),l[e.depth]||(l[e.depth]=[]),l[e.depth].push(e),e.depth>s&&(s=e.depth)}));let i=o.Wem(t,(e=>e.data.data.size));this.Extent=i,this.taxValues=[];const r=o.Nb1().startAngle((e=>this.x(e.x0))).endAngle((e=>this.x(e.x1))).innerRadius((e=>Math.max(0,this.y(e.y0)))).outerRadius((e=>Math.max(0,this.y(e.y1))));return this.arc=r,this.maxDepth=s,this.taxValues=n,o.uKc()(t)},textFits(e){const t=this.x,a=this.y,s=5,n=t(e.x1)-t(e.x0),l=Math.max(0,(a(e.y0)+a(e.y1))/2),i=l*n;return e.data.data.target.length*s<i},focusOn(e={x0:0,x1:1,y0:0,y1:1}){const t=this.x,a=this.y,s=this.svg,n=this.middleArcLine,l=s.transition().duration(750).tween("scale",(()=>{const s=o.sXR(t.domain(),[e.x0,e.x1]),n=o.sXR(a.domain(),[e.y0,1]);return e=>{t.domain(s(e)),a.domain(n(e))}}));l.selectAll("path.main-arc").attrTween("d",(e=>()=>this.arc(e))),l.selectAll("path.hidden-arc").attrTween("d",(e=>()=>n(e))),l.selectAll("text").attrTween("display",(e=>()=>this.textFits(e)?null:"none")),this.moveStackToFront(e),this.setChildren(e)},setChildren(e){let t=[];const a=this;if(e.children){let s=e.children.map((e=>(t.push({abu:e.data.data.value,rank_code:e.data.data.rank_code,label:e.data.data.target,num_fragments_clade:e.data.data.num_fragments_clade,text:a.getText(e.data.data),taxid:e.data.data.taxid}),e.data.data.rank_code)));this.childrenTaxes=t,this.$emit("changeAttribute",s[0])}else this.childrenTaxes=[]},moveStackToFront(e){const t=this.moveStackToFront;this.svg.selectAll(".slice").filter((t=>t===e)).each((function(e){this.parentNode.appendChild(this),e.parent&&t(e.parent)}))}},async mounted(){this.dimensions.windowHeight=window.innerHeight,this.dimensions.windowWidth=window.innerWidth,this.dimensions.height=2*this.$refs.boxContainer.clientHeight,this.dimensions.width=.6*this.$refs.boxContainer.clientWidth,this.inputdata&&this.makeSunburst(this.inputdata)}},Ie=Ze,Le=(0,u.Z)(Ie,Ve,Pe,!1,null,null,null),Ne=Le.exports;p()(Le,{VCol:h.Z,VContainer:f.Z,VRow:g.Z});var Re={name:"RunStats",components:{Sankey:_e,Sunburst:Ne,Plates:S,Datatable:$e},computed:{determineSize(){return 1==this.tab?this.selectedsamples.length%3==0?6:1==this.selectedsamples.length?12:(this.selectedsamples.length,6):this.selectedsamples.length%2==0||1==this.selectedsamples.length?12:6}},props:["socket","selectedsamples","sampleData","namesData","bundleconfig","fullsize"],watch:{sampleData:{deep:!0,handler(e){let t=[];for(let n of Object.values(e))n&&t.push([...new Set(n.map((e=>e.rank_code)))]);let a=[];const s=this;e&&Object.keys(e).length>0&&Object.keys(e).map((t=>{e[t]&&Object.values(e[t]).forEach((e=>{e.samplename=t,s.$set(s.selectedsamplesList,e.taxid,{taxid:e.taxid,full:e.full}),a.push(e)}))})),t=[...new Set(t.flat())],this.ranks=t,this.getUniqueLabels(),this.$set(this,"fullArray",a)}},selectedNameAttr:{deep:!0,handler(e){}},selectedAttribute:{deep:!0,handler(){this.getUniqueLabels()}}},data(){return{selectedTaxid:0,selectedName:null,fullArray:[],selectedsamplesList:{},full:!1,selectedNameAttr:"default (scientific name)",taxa:[],selectedAttribute:"S",legendPlacement:"bottom",legendPlacements:["bottom","side"],dimensions:{windowHeight:0,windowWidth:0,height:0,width:0},tab:1,ranks:[],selectedSample:null,tabs:[{name:"Top",component:"Plates",type:"json"},{name:"Sunburst",component:"Sunburst",type:"json"},{name:"Sankey",component:"Sankey",type:"report"},{name:"Table",component:"Datatable",type:"report"}]}},methods:{getUniqueLabels(){let e=[],t=this.sampleData;for(let a of Object.values(t))if(a){let t=a.filter((e=>e.rank_code==this.selectedAttribute)).map((e=>e.target)),s=e.concat(t);e=s}e=[...new Set(e)],this.$set(this,"taxa",e)},jumpTo(e){this.selectedTaxid=e},updateSelected(e){this.selectedTaxid=e.taxid},changeAttribute(e){this.selectedAttribute=e||"base",this.getUniqueLabels()}},async mounted(){}},Oe=Re,je=a(344),ze=(0,u.Z)(Oe,de,ce,!1,null,null,null),Be=ze.exports;p()(ze,{VAutocomplete:je.Z,VBtn:N.Z,VCol:h.Z,VContainer:f.Z,VIcon:q.Z,VRow:g.Z,VSelect:v.Z,VSpacer:x.Z,VTab:ee.Z,VTabItem:te.Z,VTabs:ae.Z,VTabsItems:se.Z,VTabsSlider:ne.Z,VToolbar:le.Z,VToolbarTitle:y.qW});var Ee=a(6470),Me=a.n(Ee),Fe=a(5108),qe={name:"App",components:{Plates:S,Samplesheet:oe,RunStats:Be},beforeDestroy(){if(this.interval)try{clearInterval(this.interval)}catch(e){Fe.error(e)}},computed:{direction(){return!1===this.navigation.shown?"Open":"Closed"},samplekeys(){return Fe.log(this.fullData),Object.keys(this.fullData)},icon(){return this.selectedAllSamples?"mdi-checkbox-marked":this.selectedSomeSamples?"mdi-minus-box":"mdi-checkbox-blank-outline"},selectedAllRanks(){return this.defaultsList.length===this.defaults.length},selectedSomeRanks(){return this.defaults.length>0&&!this.selectedAllRanks},selectedAllSamples(){return this.samplekeys.length===this.selectedsamples.length},selectedSomeSamples(){return this.selectedsamples.length>0&&!this.selectedAllSamples}},data(){return{search:"",queueLength:0,manuals:{},recentDataFileadded:null,socket:{},navigation:{shown:!0,width:550,borderSize:3},anyRunning:!1,pausedServer:!1,selectedsamples:[],selectedsamplesAll:[],status:{},uniquenametypes:{"default (scientific name)":1},uniquenametypesarr:[],config:{},current:{},bundleindex:1,topLevelSampleNames:[],names_file_input:null,names_file:"/names.tsv",seen:[],mapped_names:{},database_file:null,db_option:"file",selectedData:{},db_options:["file","path"],stagedData:{},paused:!1,dialog:!1,connectedStatus:"Not connected!",message:"No message yet!",inputdata:null,sampledata:{},samples:[],selectedsample:null,fullData:[],type:"single",database:null,watchdir:null,playbackdata:null,bundleconfig:null,runBundle:!0,interval:null,nodeCountMax:0,defaults:["K","R","R1","U","P","G","D","D1","O","C","S","F","S1","S2","S3","S4"],defaultsList:["U","K","P","D","D1","G","O","C","S","F","S1","S2","S3","S4"],maxDepth:30,samplesheetdata:[],samplesheet:null,minDepth:0,minPercent:.005,jsondata:null,matchPaired:".*_[1-2].fastq.gz",logs:[],fullsize:{},matchSingle:".*fastq",ext:".fastq",compressed:!1,filepath:"sample_metagenome.second.report",tab:0,gpu:!1,tabs:[{name:"Run Stats",icon:"square",component:"RunStats"}]}},watch:{gpu(e){try{this.sendMessage(JSON.stringify({type:"gpu",gpu:e}))}catch(t){Fe.error(t)}},selectedsamples(e){let t={};e.map((e=>t[e]=this.sampledata[e])),this.selectedData=t},async names_file_input(e){let t=new FileReader;const a=this;async function s(){let e=await o.tJ3(t.result);a.mapData(e)}t.addEventListener("load",s,!1),t.readAsText(e)},maxDepth(){this.filter()},paused(e){this.sendMessage(JSON.stringify({type:"pause",pause:e}))},minDepth(){this.filter()},defaults(){this.minDepth=0,this.maxDepth=20,this.minPercent=0,this.filter()},minPercent(){this.filter()}},async mounted(){this.setBorderWidth(),this.setEvents(),this.importNames(this.names_file);try{let e="//data/Samplesheet.csv".replace("//","/"),t=await o.gyn(`${e}`);t=t.filter((e=>(e.demux="true"==e.demux||"TRUE"==e.demux||"True"==e.demux,e.compressed="true"==e.compressed||"TRUE"==e.compressed||"True"==e.compressed,e.sample&&""!=e.sample))),this.samplesheet=e,this.samplesheetdata=t,0==this.samplesheetdata.length&&(this.navigation.shown=!0)}catch(a){Fe.error(a,"<<<")}const e=this;let t="Acinetobacter johnsonii;Acinetobacter genomospecies 7 (synonym), Acinetobacter genomosp. 7 (not a cat) (synonym)";e.extractValue(t);this.connect()},methods:{deleteRow(e){this.manuals[e]=null,this.topLevelSampleNames[e]&&this.topLevelSampleNames[e].map((e=>{this.selectedData[e]=null;let t=this.selectedsamples.findIndex((t=>t===e));Fe.log(t),t>=0&&this.selectedsamples.splice(t,1)}))},addDropFileData(e){this.addData(e.dataTransfer.files[0])},addDropFile(e){this.names_file_input=e.dataTransfer.files[0]},addData(e){const t=this;let a=new FileReader;a.addEventListener("load",n,!1),a.readAsText(e);let s=Me().parse(e.name).name;async function n(){await t.importData(a.result,null,s,!0)}},setBorderWidth(){let e=this.$refs.information_panel_drawer.$el.querySelector(".v-navigation-drawer__border");e.style.width=this.navigation.borderSize+"px",e.style.cursor="ew-resize"},setEvents(){const e=this.navigation.borderSize,t=this.$refs.information_panel_drawer.$el,a=t.querySelector(".v-navigation-drawer__border"),s=this,n=t.classList.contains("v-navigation-drawer--right")?"right":"left";function l(e){document.body.style.cursor="ew-resize";let a="right"===n?document.body.scrollWidth-e.clientX:e.clientX;t.style.width=a+"px"}a.addEventListener("mousedown",(function(a){if(a.offsetX<e){a.x;t.style.transition="initial",document.addEventListener("mousemove",l,!1)}}),!1),document.addEventListener("mouseup",(function(){t.style.transition="",s.navigation.width=t.style.width,document.body.style.cursor="",document.removeEventListener("mousemove",l,!1)}),!1)},pausedChange(e){this.paused=e},async connect(){const e="https:"===window.location.protocol?"wss:":"ws:",t=":3000",a=e+"//"+window.location.hostname+t+"/ws",s=this;s.socket=await new WebSocket(a),s.socket.onopen=e=>{Fe.log("Websocket connected."),s.connectedStatus="Connected",s.sendMessage(JSON.stringify({type:"message",message:"Hello, server."})),s.sendMessage(JSON.stringify({type:"gpu",gpu:s.gpu})),s.sendMessage(JSON.stringify({type:"start",samplesheet:s.samplesheetdata,overwrite:!1}))},this.socket.onmessage=e=>{let t=JSON.parse(e.data);if("data"==t.type)(async()=>{await this.importData(t.data,null,t.samplename),this.topLevelSampleNames[t.topLevelSampleNames]||(this.topLevelSampleNames[t.topLevelSampleNames]=[]);let e=this.topLevelSampleNames[t.topLevelSampleNames].indexOf(t.samplename);e<0&&this.topLevelSampleNames[t.topLevelSampleNames].push(t.samplename)})().catch((e=>{Fe.error(e)}));else if("add"==t.type)this.samplesheetdata.push(t.data);else if("playback"==t.type)this.playbackdata=t.message;else if("basepathserver"==t.type)this.basepathserver=t.data;else if("getbundleconfig"==t.type)this.bundleconfig=t.data;else if("queueLength"==t.type)this.queueLength=t.data;else if("logs"==t.type){this.logs.push(t.data);const e=this.logs.slice(-100);this.logs=e}else if("config"==t.type)this.config=t.message;else if("flushed"==t.type)for(let a of Object.keys(this.current))this.current[a]=null;else"reads"==t.type?this.reads=t.message:"error"==t.type||"message"==t.type||("paused"==t.type?this.pausedServer=t.message:"anyRunning"==t.type?this.anyRunning=t.status:"recentQueue"==t.type?(this.status[t.data.name]||(this.status[t.data.name]=[]),t.data.index>=0?this.$set(this.status[t.data.name],t.data.index,t.data):this.$set(this.status[t.data.name],this.status[t.data.name].length>0?this.status[t.data.name].length-1:0,t.data)):"status"==t.type?(this.status[t.samplename]||(this.status[t.samplename]=[]),this.$set(this.status[t.samplename][t.index],"status",t.status),this.$set(this.status[t.samplename][t.index],"sample",t.sample),this.$set(this.current,t.samplename,t.status.running)):this.message=t.message)},s.socket.onclose=function(e){Fe.log("Socket is closed. Reconnect will be attempted in 1 second.",e.reason),setTimeout((function(){s.connect()}),2e3)},s.socket.onerror=function(e){Fe.error("Socket encountered error: ",e.message,"Closing socket"),s.connectedStatus="Disconnected Server, reattempting every 1 second. Check Logs and Network Settings",s.socket.close()}},extractValue(e){let t={};if(e){let a=e.split(";");a.length>1?(a=a[1],a=a.split(", "),a&&a.length>0&&a.forEach((e=>{var a=new RegExp(/(?<=\()(.*?)(?=\))|(?<=^)(.*)(?=\()/,"g"),s=e.match(a);let n=null,l=null;s&&s.length>1&&(l=s[0].trim(),n=s[1].trim(),this.uniquenametypes[n]||(this.uniquenametypes[n]=1),t[n]?t[n].push(l):t[n]=[l])}))):a=e}return t},runBundleUpdate(){this.sendMessage(JSON.stringify({type:"runbundle",config:this.runBundle,message:`Run Bundle config updates ${this.runBundle} `}))},updateConfig(e,t){"kraken2"==t?this.sendMessage(JSON.stringify({type:"updateConfig",config:e,message:"Config Updated for data, select restart run  next please "})):"bundle"==t&&this.sendMessage(JSON.stringify({type:"updateBundleconfig",config:e,message:"Bundle Config Updated for data, select restart run  next please "}))},filter(){let e={};const t=this;this.selectedsamples.map((a=>{let s=t.filterData($().cloneDeep(t.fullData[a]));s=t.parseData(s),e[a]=s})),this.selectedData=e},async barcode(e){this.sendMessage(JSON.stringify({type:"barcode",sample:e.sample,kits:e.kits,dirpath:e.path_1}))},async rerun(e,t){this.sendMessage(JSON.stringify({type:"rerun",overwrite:!0,sample:t,index:e,message:`Begin rerun of ${t}, job # ${e}`}))},async sendNewWatch(e){let t=e.overwrite,a=e.sample;this.sampledata={},this.stagedData={},a?this.sendMessage(JSON.stringify({type:"restart",overwrite:t,sample:a,message:`Begin watching directory ${this.watchdir}, classify with ${this.database} `})):this.sendMessage(JSON.stringify({type:"start",samplesheet:this.samplesheetdata,overwrite:t,message:`Begin watching directory ${this.watchdir}, classify with ${this.database} `}))},cancel(e){this.sendMessage(JSON.stringify({type:"cancel",index:e.index,sample:e.sample,message:`Cancel Index Job: ${e.index} for sample: ${e.sample}`}))},updateData(e){this.samplesheetdata=e,this.sendMessage(JSON.stringify({type:"start",samplesheet:this.samplesheetdata,overwrite:!1,message:`Begin watching directory ${this.watchdir}, classify with ${this.database} `}))},addDropFiles(e){this.value=Array.from(e.dataTransfer.files),this.database_file=this.value[0].path},toggleSamples(){this.$nextTick((()=>{this.selectedAllSamples?this.$set(this,"selectedsamples",[]):this.selectedsamples=this.samplekeys.slice()}))},toggle(){this.$nextTick((()=>{this.selectedAllRanks?this.defaults=[]:this.defaults=this.defaultsList}))},waitForOpenConnection:function(){return new Promise(((e,t)=>{const a=10,s=200;let n=0;const l=setInterval((()=>{n>a-1?(clearInterval(l),t(new Error("Maximum number of attempts exceeded."))):this.socket.readyState===this.socket.OPEN&&(clearInterval(l),e()),n++}),s)}))},sendMessage:async function(e){if(this.socket.readyState!==this.socket.OPEN)try{await this.waitForOpenConnection(this.socket),this.socket.send(e)}catch(t){Fe.error(t)}else this.socket.send(e)},parseData(e){function t(e,s){return s-1<=-1?{name:"base",taxid:-1,value:0}:a[s-1]?e[s-1]:t(e,s-1)}let a={};return e=e.map((e=>{let s=t(a,e.depth);return-1==e.taxid?(e.source=null,e.parenttaxid=null):(e.source=s.name,e.parenttaxid=s.taxid),a[e.depth]={name:e.target,taxid:e.taxid,value:e.num_fragments_assigned},e})),e},filterData(e){let t=$().cloneDeep(e);return t=t.filter((e=>{let t=-1==e.taxid||this.defaults.indexOf(e.rank_code)>-1&&e.depth<=this.maxDepth&&e.depth>=this.minDepth&&this.minPercent<=e.value/100;return t})),t},mapData(e){e.forEach((e=>{this.mapped_names[e.Taxid]=e}))},async importNames(e){try{let t=await o.pvA(e);this.mapData(t)}catch(t){Fe.error(t)}},async importData(e,t,a,s){let n;n="file"==t?await o.fLW(e):e;let l=this.selectedsamplesAll.indexOf(a);-1==l&&(this.selectedsamplesAll.push(a),this.selectedsamples.push(a));let i=0;const r=this;let d={},c={value:0,num_fragments_clade:0,num_fragments_assigned:0,rank_code:"1B",taxid:-1,target:"base",source:null,depth:0},u=o.E0m(n,(e=>{e[0]=e[0].trim(),e[5]=e[5]?e[5]:"Unknown",e[5]=e[5].replace(/\t/,"");let t=e[5].search(/\S/);e[5]=e[5].trim();let a=0,s=e[5]?`${e[5]}`:"root",n=s.replace(/\;.*/,""),l=r.extractValue(s),o={value:parseFloat(e[0]),num_fragments_clade:parseInt(e[1]),num_fragments_assigned:parseInt(e[2]),rank_code:e[3],taxid:e[4],size:a,target:n,full:`${e[4]} ${s}`,objfull:l,source:null,depth:t};return i+=parseInt(e[2]),0==t&&(c.value+=parseFloat(o.value),c.num_fragments_clade+=parseInt(o.num_fragments_clade)),d[e[3]]=1,o}));if(this.fullsize[a]=i,u.unshift(c),this.fullData[a]=u,u=this.filterData(u),u=this.parseData(u),Object.keys(d).forEach((e=>{-1==this.defaultsList.indexOf(e)&&this.defaultsList.push(e)})),this.stagedData[a]=u,!this.paused){this.sampledata[a]=u;let e=this.selectedsamples.indexOf(a);e>-1?this.selectedData[a]=u:-1==e&&this.selectedData[a]&&delete this.selectedData[a]}return s&&(this.manuals[a]=1),u}}},We=qe,Je=a(998),Ue=a(6232),He=a(4127),Ye=a(3059),Ke=a(9709),Qe=a(7414),Ge=(0,u.Z)(We,n,l,!1,null,null,null),Xe=Ge.exports;p()(Ge,{VAlert:I.Z,VApp:Je.Z,VAppBar:Ue.Z,VAutocomplete:je.Z,VBtn:N.Z,VCheckbox:j.Z,VChip:He.Z,VCol:h.Z,VContainer:f.Z,VDivider:E.Z,VFileInput:F.Z,VIcon:q.Z,VListItem:U.Z,VListItemAction:H.Z,VListItemContent:Y.km,VListItemTitle:Y.V9,VMain:Ye.Z,VNavigationDrawer:Ke.Z,VProgressCircular:K.Z,VRow:g.Z,VSelect:v.Z,VSlider:Qe.Z,VSpacer:x.Z,VTabItem:te.Z,VTabsItems:se.Z,VTextField:b.Z,VToolbarTitle:y.qW,VTooltip:ie.Z});var et=a(1705);s.Z.use(et.Z);var tt=new et.Z({icons:{iconfont:"md"}}),at=a(3982),st=a.n(at),nt=a(6540);s.Z.component("downloadExcel",nt.Z),s.Z.config.productionTip=!1,s.Z.use(st()),s.Z.use(T()),new s.Z({vuetify:tt,render:e=>e(Xe)}).$mount("#app")}},t={};function a(s){var n=t[s];if(void 0!==n)return n.exports;var l=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(l.exports,l,l.exports,a),l.loaded=!0,l.exports}a.m=e,function(){var e=[];a.O=function(t,s,n,l){if(!s){var i=1/0;for(c=0;c<e.length;c++){s=e[c][0],n=e[c][1],l=e[c][2];for(var r=!0,o=0;o<s.length;o++)(!1&l||i>=l)&&Object.keys(a.O).every((function(e){return a.O[e](s[o])}))?s.splice(o--,1):(r=!1,l<i&&(i=l));if(r){e.splice(c--,1);var d=n();void 0!==d&&(t=d)}}return t}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[s,n,l]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,l,i=s[0],r=s[1],o=s[2],d=0;if(i.some((function(t){return 0!==e[t]}))){for(n in r)a.o(r,n)&&(a.m[n]=r[n]);if(o)var c=o(a)}for(t&&t(s);d<i.length;d++)l=i[d],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(c)},s=self["webpackChunkmytax2"]=self["webpackChunkmytax2"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(3690)}));s=a.O(s)})();
//# sourceMappingURL=app.cefca570.js.map